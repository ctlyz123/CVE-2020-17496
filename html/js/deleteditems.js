/*=======================================================================*\
|| ###################################################################### ||
|| # vBulletin 5.6.0
|| # ------------------------------------------------------------------ # ||
|| # Copyright 2000-2020 MH Sub I, LLC dba vBulletin. All Rights Reserved.  # ||
|| # This file may not be redistributed in whole or significant part.   # ||
|| # ----------------- VBULLETIN IS NOT FREE SOFTWARE ----------------- # ||
|| # http://www.vbulletin.com | http://www.vbulletin.com/license.html   # ||
|| ###################################################################### ||
\*========================================================================*/
(function(B){window.vBulletin=window.vBulletin||{};B(document).off("click",".deletedItems-remove").on("click",".deletedItems-remove",function(){$button=B(this);var C,D=false;if($button.parents("#pmFloatingBarContent").hasClass("deletedItems-paginator")){C=getSelectedMessages()}else{C=[$button.parents(".list-item").data("nodeId")]}if(C.length>0){vBulletin.AJAX({call:"/ajax/api/node/deleteNodes",data:{nodeids:C,hard:1},success:function(E){location.reload()}})}});B(".deletedItems-restore").off("click").on("click",function(E){$button=B(this);var C,D=false;if($button.parents("#pmFloatingBarContent").hasClass("deletedItems-paginator")){C=getSelectedMessages()}else{C=[$button.parents(".list-item").data("nodeId")]}if(C.length>0){vBulletin.AJAX({call:"/ajax/api/node/undeleteNodes",data:{nodeids:C},success:function(F){location.reload()}})}});B(document).off("click","#privatemessagePaging .deletedItemsPrev").on("click","#privatemessagePaging .deletedItemsPrev",function(D){D.preventDefault();var C=B(this).closest("#privatemessagePaging").find(':input[type=hidden][name="prev-page"]').val();A(B(this),C)});B(document).off("click","#privatemessagePaging .deletedItemsNext").on("click","#privatemessagePaging .deletedItemsNext",function(D){D.preventDefault();var C=B(this).closest("#privatemessagePaging").find(':input[type=hidden][name="next-page"]').val();A(B(this),C)});B(document).off("keypress","#privatemessagePaging .deletedItemsPageTo").on("keypress","#privatemessagePaging .deletedItemsPageTo",function(D){if(D.keyCode==13){D.preventDefault();var E=B(this);var C=parseInt(E.val(),10);if(isNaN(C)){vBulletin.error("error","please_enter_a_valid_page_number");return false}A(E,C)}});B("#deletedItemsFilters").trigger("reset").find(".filter-options input").off("click").on("click",function(C){deletedItemsFilter.apply(this)});function A(C,K,D){if(!C){C=B("#private-message-toolbar .deletedItems-paginator .deletedItemsPageTo");if(C.length==0){return false}}if(!D){D=0}var G=C.closest(".deletedItems-paginator"),E=G.find("#maxPageNum").filter(":input[type=hidden]").val(),F=parseInt(G.find(":input[type=hidden][name=pagenum]").val(),10),H=parseInt(G.find(":input[type=hidden][name=per-page]").val(),10),J=G.find("input[name=routeInfoJson]").val(),I=B("#privateMessageContainer .main-pane .pending-posts-container");K=parseInt(K,10);if(isNaN(K)||isNaN(E)||isNaN(F)){return false}if((K<1)||(K>E)){if(!C.is(".h-disabled")){vBulletin.error("error","please_enter_a_valid_page_number")}return false}else{if((K==F)&&!D){return false}}var L={};B("#deletedItemsFilters input:checked").each(function(){L[this.name]=this.value});if(L.time){L.time={from:L.time}}vBulletin.AJAX({call:"/ajax/render/privatemessage_deleteditems_main",data:{setCurrentPage:K,setPerPage:H,getPagingInfo:D,options:L,routeInfoJson:J,isAjaxTemplateRenderWithData:true,},success:function(O){I.html(O.template);var N=0,M=0;if(K<E){M=K+1;if(K>1){N=K-1}}else{N=K-1}G.find(":input[type=hidden][name=pagenum]").val(K);G.find(":input[type=hidden][name=next-page]").val(M);G.find(":input[type=hidden][name=prev-page]").val(N);G.find(".deletedItemsNext").toggleClass("h-disabled",!M);G.find(".deletedItemsPrev").toggleClass("h-disabled",!N);G.find(".deletedItemsPageTo").val(K);if(D){var P=B("#privateMessageContainer .main-pane .pending-posts-container .pending-posts-pageinfo");G.find("#maxPageNum").filter(":input[type=hidden]").val(parseInt(P.find(".totalpages").val(),10));G.find(".deletedItemsPageCount").text(parseInt(P.find(".totalpages").val(),10));B(".folder-list .folder-item.pending-posts .count",$pmWidget).text(parseInt(P.find(".totalcount").val(),10))}},})}deletedItemsFilter=function(D){$paginateButton=B("#private-message-toolbar .deletedItems-paginator .deletedItemsPageTo");if($paginateButton.length){A($paginateButton,1,true);return }var C={};B(this).closest(".filter-options-list").find("input:checked").each(function(){C[this.name]=B(this).val()});if(C.time){C.time={from:C.time}}B(this).attr("checked","checked");C.page=1;C.perpage=pmPerPage;vBulletin.AJAX({call:"/ajax/render/privatemessage_deleteditems_main",data:{options:C,isAjaxTemplateRenderWithData:true,},success:function(E){B("#privateMessageContainer .pending-posts-container").html(E.template);pmPageNum=1}})}})(jQuery);