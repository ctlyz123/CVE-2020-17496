/*=======================================================================*\
|| ###################################################################### ||
|| # vBulletin 5.6.0
|| # ------------------------------------------------------------------ # ||
|| # Copyright 2000-2020 MH Sub I, LLC dba vBulletin. All Rights Reserved.  # ||
|| # This file may not be redistributed in whole or significant part.   # ||
|| # ----------------- VBULLETIN IS NOT FREE SOFTWARE ----------------- # ||
|| # http://www.vbulletin.com | http://www.vbulletin.com/license.html   # ||
|| ###################################################################### ||
\*========================================================================*/
window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["action","active","ad_list_description","add_modules","add_subforum","adding_multiple_modules_not_allowed","all","applying_new_template","are_you_sure_want_to_delete_ad_x","cancel","cannot_add_system_module","cannot_convert_channel","cannot_remove_system_module","channels","check_to_hide_module","choose_base_module","choose_options_site_logo","click_text_edit_title","confirm_deletion_gcpglobal","confirm_deletion_x","confirm_remove_page_desc","content_types","create_ad","create_new_custom_module","delete","display_order","do_you_want_to_cancel_editing_search_module","do_you_want_to_exit_without_saving_page","do_you_want_to_remove_channel","do_you_want_to_remove_forum","do_you_want_to_remove_module","do_you_want_to_remove_tab","drag_and_drop_module_here","drop_page_here","dropping_container_module_into_container_module_not_allowed","edit","edit_ad_x","edit_blog_categories","edit_custom_html_module","edit_navigation_item","edit_search_module","edit_site_logo","error_adding_widgets","error_cloning_widget","error_deleting_page","error_fetching_channels","error_loading_search_config_script","error_processing_site_logo","error_renaming_module_title","error_retrieving_cloned_widget_template","error_retrieving_configuration","error_retrieving_list_user_groups","error_retrieving_modules","error_retrieving_navigation_bar_configuration","error_retrieving_page_map","error_retrieving_templates","error_saving_configuration_module","error_saving_forums","error_saving_forums_code","error_saving_navigation_bar_configuration","error_saving_page","error_saving_search_config","error_saving_site_logo","error_uploading_logo","exit_without_saving_page","expand","forum_changes_will_be_lost","input_navigation_item_name","input_target_url","invalid_image_url","main_navigation_bar","make_category","make_forum","manage_ads","module_configuration","module_icon","move_not_allowed","moving_main_nav_to_own_sub_nav_error","moving_main_nav_with_sub_nav_error","new_navigation_item","new_subnavigation_item","next","no","no_ad_added","no_configurations_found","no_modules","no_permission","none","overwrite_template_continue","page_template_title_cannot_be_empty","page_title_cannot_be_empty","please_choose_overwrite_template_options","please_enter_channel_title","please_enter_new_module_title","please_enter_new_template_name","please_enter_page_name","previous","remove_channel","remove_channel_q","remove_forum","remove_forum_q","remove_module_q","rename","rename_custom_module","reset","save","save_new_page","save_page","search_results","select_edit_link_header","special_options","sub_navigation_bar","subchannels_will_be_deleted","switch_template","template_changes_will_be_lost","this_url_is_already_used","title","unable_to_delete_widget_instances","uncheck_to_unhide_module","url_too_long","user_group_settings","warning","warning_gcpuser","yes","you_are_here","you_can_also_drag_and_drop_modules_here","you_cannot_revert_this_layout_confirm","you_must_specify_a_screen_layout"]);(function(AY){var h,AX,q,Ah,AI,d,AE=[],AG,AM,x=false,AA=false,r={},AC=false,AJ=false,o=false,z=false,Ae=false,U=false,y=false,k={},AB={},AR={},I={},e,AQ,u,Af={saveNewWidgetInstance:false},A=AY("<div>"),R;function Ap(){window.setTimeout(function(){if(vBulletin.vBScroller&&vBulletin.vBScroller.initializeScroller){AY(".js-vbscroller-wrapper:visible").each(function(){vBulletin.vBScroller.initializeScroller(AY(this))})}},0)}function Ao(){var Ar=AY("#edit-page-dropdown .panel .panel-main-content:visible");if(Ar.length>0){var Aq=parseFloat(Ar.css("margin-left"))+parseFloat(Ar.css("margin-right"))+parseFloat(Ar.css("border-left-width"))+parseFloat(Ar.css("border-right-width"))+parseFloat(Ar.css("padding-left"))+parseFloat(Ar.css("padding-right"));AY("#edit-page-dropdown .panel .panel-main-content").width(AY("#edit-page-dropdown .panel:visible").width()-AY("#edit-page-dropdown .panel .panel-header-text:visible").outerWidth(true)-Aq-1);AY("#edit-page-dropdown form .form-gutter-right").width(Math.ceil((AY("#edit-page-dropdown form:visible").width()-AY("#edit-page-dropdown .panel:visible").outerWidth(true))/2));Ap()}}function AZ(Aq,At){if(!Aq.is(".container-widget")){return }var Ar=Aq.find(".js-admin-widget-list");Ar.css({minHeight:"35px",height:"auto",paddingBottom:"10px"}).closest(".js-widget-content").removeClass("h-hide").css({minHeight:"35px"});if(!AY.isEmptyObject(At)){var As=[];AY.each(At,function(){As.push(this)});As.sort(function(Av,Au){if(Av.displayorder==Au.displayorder){return 0}return Av.displayorder<Au.displayorder?-1:1});AY.each(As,function(){var Au=AY(this.rendered_template);if(this.hidden){Au.addClass("hidden-widget")}Ar.append(Au)})}}function AP(At,Aq,Av){var Ar=At.attr("data-widget-id"),Au=At.attr("data-widget-instance-id")||"",As={widgetinstanceid:Au,widgetid:Ar,guid:"",userid:0,channelId:0,withTemplate:false,};if(typeof Av=="undefined"){Av=false}else{Av=Boolean(Av)}vBulletin.AJAX({call:"/ajax/api/widget/fetchConfigAndIsUserEditable",data:As,success:function(Aw){console.log("fetchConfig in getModuleConfig() successful! result:"+JSON.stringify(Aw));var Ax=Aw;if(!Av){Ax=Aw.config}if(typeof Aq=="function"){Aq(Ax)}}})}function AF(Ar){if(!Ar.tab_data){Ar.tab_data=[]}if(!Ar.default_tab){Ar.default_tab=0}if(!Ar.submodules_key){console.log({msg:"Missing submodules key!",config:Ar,});Ar.submodules_key="tabbedContainerSubModules__temp"}if(!Ar.display_tabs){Ar.display_tabs=""}if(Ar.display_tabs==""){var Aq={};AY.each(Ar.tab_data,function(At,As){Aq[At]="1"});Ar.display_tabs=Aq}return Ar}function Y(){if(typeof u=="undefined"){u=AY("#config_pagetemplateid").val()||AY("#select-template input[type=radio]:checked").val()||""}return u}function f(Aq){Aq=parseInt(Aq,10);u=Aq;AY("#config_pagetemplateid, #save-page-form #pagetemplateid-yes, #save-page-form #pagetemplateid-new").val(u)}function c(Ar,Aq){console.log({msg:"saveModuleConfig()",$module:Ar,config:Aq,});vBulletin.AJAX({call:"/ajax/api/widget/saveAdminConfig",data:{widgetid:Ar.attr("data-widget-id"),widgetinstanceid:Ar.attr("data-widget-instance-id")||"",pagetemplateid:Y(),data:Aq},complete:function(){AY("body").css("cursor","auto")},success:function(As){console.log("saveAdminConfig in saveModuleConfig() successful! result:"+JSON.stringify(As))}})}function v(Ar){var Aq=Ar.parents(".canvas-widget");if(Aq.length){$parentModule=AY(Aq[0]);return parseInt($parentModule.data("widget-instance-id"),10)}return 0}function T(Ar){var Aq=Ar.parents(".canvas-widget[data-is-tabbed-container='true']");if(Ar.data("is-tabbed-container")){console.log("---updating self tabbed container config");X(Ar)}if(Aq.length==0){console.log("---no parent tabbed container to update");return }console.log("---updating parent tabbed container config");X(AY(Aq[0]))}function i(Ar){var Aq={};Ar.find("> .js-admin-widget-content > .js-admin-widget-tab").each(function(){var Av=AY(this),Au=[],As=Av&&Av.data("tab-number")||0,At=Av&&Av.data("tab-title")||"";Aq[As]={title:At};Av.find("> .widget-content > .canvas-layout-row > .canvas-widget-list > .canvas-widget:not(.dummy-widget)").each(function(){var Az=AY(this),Aw=Az.data("widget-id"),Ax=Az.data("widget-instance-id")||Az.attr("data-widget-instance-id"),Ay={};if(Ax){Ay.widgetinstanceid=Ax}if(Aw){Ay.widgetid=Aw}if(!AY.isEmptyObject(Ay)){Au.push(Ay)}});Aq[As]["widgets"]=Au});return Aq}function X(Ar){var Aq=function(As){var As=AF(As);As.tab_data=i(Ar);if(!AY.isEmptyObject(As)){c(Ar,As)}};AP(Ar,Aq)}function AT(Aq){vBulletin.AJAX({call:"/ajax/api/widget/deleteWidgetInstances",data:{widgetInstanceIds:Aq},success:function(Ar){console.log("saveAdminConfig in saveModuleConfig() successful! removeInstances: "+JSON.stringify(Aq)+" result:"+JSON.stringify(Ar))},api_error:vBulletin.ajaxtools.logApiError,})}function m(Au,At,Ar,Av){var Aw=Y(),As=(Aw==""||Aw==0),Aq="save-new-widgetinstance-pagetemplateid-ready";if(As){if(!Af.saveNewWidgetInstance){Af.saveNewWidgetInstance=true}else{A.one(Aq,function(Ax){m(Au,At,Ar,Av)});return }}vBulletin.AJAX({call:"/ajax/api/widget/saveNewWidgetInstance",data:{containerinstanceid:Au,widgetid:At,pagetemplateid:Aw,subWidgetConfig:Ar,},success:function(Ax){console.log({msg:"/ajax/api/widget/saveNewWidgetInstance success!",result:Ax,});if(As&&Ax.pagetemplateid){f(Ax.pagetemplateid);A.trigger(Aq)}if(Ax.widgetinstanceid){if(typeof Av=="function"){Av(Ax.widgetinstanceid)}}}})}function l(Ay){if(!Ay.data("is-tabbed-container")){return }var Aw=Ay.attr("data-widget-instance-id");if(!Aw){var As=v(Ay),Ar=function(A4){console.log({msg:"added missing tabbed container widgetinstance",widgetinstanceid:A4,parentContainerinstanceid:As,});Ay.attr("data-widget-instance-id",A4);return l(Ay)};return m(As,Ay.attr("data-widget-id"),{},Ar)}if(AY.isEmptyObject(AR)){return p(l,[Ay])}if(Ay.data("tabbed-container-initialized")){return }var A2=Ay.find(".js-admin-widget-tab-panel-template"),A1=A2.find(".js-admin-widget-list"),Av=Ay.find(".js-admin-widget-tab-header-template"),Az=Ay.find(".js-admin-widget-content"),At=Az.find(".js-tab-headers"),A3=At.find(".js-tab-add"),Ax,Aq;A2.detach().removeClass("js-admin-widget-tab-panel-template");Av.detach().removeClass("js-admin-widget-tab-header-template");Az.tabs({beforeActivate:function(A4,A5){if(AY(A5.newTab).hasClass("js-tab-add")){return false}},});Ax=Az.tabs("widget");A1.css({minHeight:"60px",height:"auto",paddingBottom:"10px"});At.find(".js-tab-add").on("click",function(){var A4=function(A6){var A8=AF(A6.config),A9=A8.tab_data,BA=A9.length||0,A7=BA,A5=A6.isusereditable.tab_data||false;openPromptDialog({title:vBulletin.phrase.get("enter_tab_title"),message:"",buttonLabel:{okLabel:vBulletin.phrase.get("ok"),cancelLabel:vBulletin.phrase.get("cancel")},onClickOK:function(BB){if(!BB){return false}Au(BB,[],A7,A7,A5);A8.display_tabs[A7]="1";A8.tab_data=i(Ay);if(!AY.isEmptyObject(A8)){c(Ay,A8)}}})};AP(Ay,A4,true)});Av.find(".js-edit-tab-button").on("click",function(){var A8=AY(this),A4=A8.closest("li[aria-controls]"),A5=A4.attr("aria-controls"),A7=Ax.find(".js-admin-widget-tab[id='"+A5+"']"),A6=A7&&A7.data("tab-title")||"";var A9=function(BA){var BB=AF(BA),BC=BB.tab_data;openPromptDialog({title:vBulletin.phrase.get("enter_tab_title"),message:"",initialValue:A6,buttonLabel:{okLabel:vBulletin.phrase.get("ok"),cancelLabel:vBulletin.phrase.get("cancel")},onClickOK:function(BD){A4.find("span.js-tab-title").text(BD);A7.data("tab-title",BD);BB.tab_data=i(Ay);if(!AY.isEmptyObject(BB)){c(Ay,BB)}}})};AP(Ay,A9);return false});Av.find(".js-remove-tab-button").on("click",function(){var A8=AY(this),A5=A8.closest("li[aria-controls]"),A6=A5.attr("aria-controls"),A7=Ax.find(".js-admin-widget-tab[id='"+A6+"']");var A4=function(A9){var BB=AF(A9.config),BC=BB.tab_data,BD=BC.length||0,BA=A7.data("tab-number");openConfirmDialog({title:vBulletin.phrase.get("remove_tab_q"),message:vBulletin.phrase.get("do_you_want_to_remove_tab",A7.data("tab-title")),iconType:"warning",onClickYes:function(){if(BB.default_tab==BA){BB.default_tab=0}if(!Array.isArray(BB.display_tabs)){BB.display_tabs=AY.map(BB.display_tabs,function(BF){return BF})}BB.display_tabs.splice(BA,1);var BE=[];A7.find(".canvas-widget").each(function(BF,BH){var BG=AY(this).data("widget-instance-id");if(BG){BE.push(BG)}});if(BE.length){AT(BE)}A5.remove();A7.remove();At.find("li:not('.js-tab-add')").each(function(BF,BJ){var BG=AY(this),BI=BG.attr("aria-controls"),BH=Ax.find(".js-admin-widget-tab[id='"+BI+"']");if(BH.length){BH.data("tab-number",BF)}});Ax.tabs("refresh");BB.tab_data=i(Ay);if(!AY.isEmptyObject(BB)){c(Ay,BB)}AD();O();x=true}})};AP(Ay,A4,true);return false});var Au=function(BL,BB,BK,BE,BC){if(typeof BL=="undefined"){BL="Untitled Tab"}if(typeof BB=="undefined"){BB=[]}if(typeof BK=="undefined"){var A8=Ay.find(".js-admin-widget-tab");BK=A8.length}var BD=[];for(BH in BB){if(BB.hasOwnProperty(BH)){BD.push(BH)}}BD.sort(function(BN,BM){return BN-BM});var BJ=BD.length,A4=A2.clone().uniqueId().removeClass("h-hide").data("tab-number",BK).data("tab-title",BL),BI=A4.find(".js-admin-widget-list"),A6=A4.attr("id"),A7=Av.clone(true).removeClass("h-hide");A7.children("a.js-tab-header-link").attr("href","#"+A6);A7.find("span.js-tab-title").text(BL);for(j=0;j<BJ;j++){var BH=BD[j],A5=BB[BH],BF=A5.widgetid||AR[A5.guid],BA=A5.widgetinstanceid||"",A9=AY('<div data-widget-id="'+BF+'" />');A9.attr("data-tab-number",BK);A9.attr("data-widget-order",BH);A9.attr("data-widget-instance-id",BA);A9.append(AY('<img src="images/loader-box-blue.gif" /> '));BI.append(A9);if(BF){var BG=(function(BP,BN,BO,BM){return function(BV){BV=BV.filter(function(){return this.nodeType===Node.ELEMENT_NODE});if(!BO){var BQ=BP.adminconfig||{},BT=function(BY){BV.attr("data-widget-instance-id",BY);X(Ay)};m(Aw,BN,BQ,BT)}else{BV.attr("data-widget-instance-id",BO)}if(!BC){var BW=BV.find(".js-move-button"),BR=BV.find(".js-edit-button"),BX=BV.find(".js-remove-button"),BS=BV.find(".js-edit-tab-button"),BU=BV.find(".js-remove-tab-button");BW.hide();BR.hide();BX.hide();BS.hide();BU.hide();BV.addClass("js-widget-non-sortable")}BM.replaceWith(BV);BV.filter(":not(.container-widget)").find(".toggle-button").trigger("click",[true]);l(BV)}})(A5,BF,BA,A9);An(A9,BG)}}A3.before(A7);Ax.append(A4);Ax.tabs("refresh");Ax.tabs("option","active",BE);BI.prepend('<div class="canvas-widget dummy-widget dummy-widget--no-fixed-height"><span>{0}</span></div>'.format(vBulletin.phrase.get("drag_and_drop_modules_below")))};var A0=function(BA){var A6=AF(BA.config),BE=A6.tab_data,BC=BE.length,BD=A6.default_tab,A7=BA.isusereditable.tab_data||false;for(var A9=0;A9<BC;A9++){Au(BE[A9].title,BE[A9].widgets,A9,BD,A7)}if(A7){var A5,A8,A4,BB;At.sortable({helper:"clone",opacity:1,axis:"x",items:"li:not('.js-tab-add')",cancel:".js-edit-tab-button, .js-remove-tab-button",start:function(){old_numidx_to_controls={};new_controls_to_numidx={};Ax.find(".js-admin-widget-tab").each(function(BF,BG){old_numidx_to_controls[BF]=AY(this).attr("id")})},stop:function(){At.find("li:not('.js-tab-add')").each(function(BG,BK){var BH=AY(this),BJ=BH.attr("aria-controls"),BI=Ax.find(".js-admin-widget-tab[id='"+BJ+"']");if(BI.length){BI.data("tab-number",BG);Ax.append(BI)}new_controls_to_numidx[BJ]=BG});Ax.tabs("refresh");var BF=function(BG){BD=new_controls_to_numidx[old_numidx_to_controls[BD]];BG.default_tab=BD;var BJ={};for(var BK in BG.display_tabs){var BH=new_controls_to_numidx[old_numidx_to_controls[BK]],BI=BG.display_tabs[BK];BJ[BH]=BI}BG.display_tabs=BJ;BG.tab_data=i(Ay);if(!AY.isEmptyObject(BG)){c(Ay,BG)}};AP(Ay,BF)},})}else{A3.hide()}};AP(Ay,A0,true);Ay.data("tabbed-container-initialized",true)}function J(Ar,As){var Aq=AY(".js-canvas-layout-container > .canvas-layout").attr("id");if(!vBulletin.sitebuilder.tempModuleHTMLCache){vBulletin.sitebuilder.tempModuleHTMLCache={};AY(".js-canvas-layout-container .canvas-widget").each(function(){var At=AY(this).data("widget-instance-id");vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+At]=this.outerHTML})}AY(".js-canvas-layout-container").text("");vBulletin.AJAX({call:"/ajax/get-layouts-for-sitebuilder",data:{pagetemplateid:pageData.pagetemplateid,channelid:pageData.channelid},success:function(At){console.log("ajax/get-layouts-for-sitebuilder result:");console.dir(At);var Au=AY(".js-canvas-layout-container");Au.html(At.screenlayoutlist);if(At.widgets&&At.widgets.length>0){var Av=AY("#"+Aq);AY.each(At.widgets,function(Aw,Ax){var Ay=Av.find(".canvas-widget-list.section-"+Aw);AY.each(Ax,function(Az,A1){Ay.append(A1.rendered_template);var A0=Ay.find(".canvas-widget").filter(function(){return AY(this).data("widget-instance-id")==A1.widgetinstanceid});if(typeof A1.subModules!="undefined"){AZ(A0,A1.subModules)}l(A0)})})}if(vBulletin.inlinemod&&vBulletin.inlinemod.initModMenuHover){vBulletin.inlinemod.initModMenuHover()}if(typeof As=="function"){As()}},title_phrase:"sitebuilder",error_phrase:"unable_to_load_layouts"})}function N(As,Au){var Aq=Au.enableButtons,At=AY(".js-top-menu-sitebuilder--list .js-top-menu-link");if(Aq){AY(".js-top-menu-user").removeClass("h-hide");At.removeClass("b-top-menu__item-link--selected b-top-menu__item-link--disabled")}else{var Ar=AY(Au.currentButton);At.removeClass("b-top-menu__item-link--selected").addClass("b-top-menu__item-link--disabled");Ar.addClass("b-top-menu__item-link--selected");AY(".js-top-menu-user").addClass("h-hide")}}AY(document).on("vb-toggle-sitebuilder-menu",N);function Al(At){var As=AY(At.target),Aq=As.data("panel-name");if(As.is(".b-top-menu__item-link--disabled")){this.blur();At.stopPropagation();return false}if(As.is(".js-top-menu-tab--admincp")){return true}var Ar="vb-sitebuilder-panel--"+Aq;AY(document).trigger(Ar);return false}AY(document).on("click",".js-top-menu-sitebuilder--list .js-top-menu-link",Al);function Aa(As,Ar){var Aq=AY(".js-top-menu-sitebuilder .js-top-menu-link");N(null,{enableButtons:!Ar,currentButton:As});AY(document.body).toggleClass("edit-mode "+As.id,Ar).toggleClass("view-mode",!Ar);AY(".js-top-menu-user").toggleClass("h-hide",Ar)}function g(){if(!AY(this).hasClass("selected")&&!AY(document.body).hasClass("edit-mode")){Aa(this,true)}return false}vBulletin.sitebuilder.activateSB=g;function E(){Aa(this,false);return false}function b(As,Ar){var Aq=AY("<div />").append(As.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<span class="axd-placeholder">{0}'.format(vBulletin.phrase.get("x_will_show_up_here_when_saved",Ar))).replace(/<vb\:/g,"&lt;vb:").replace(/<\/vb\:/g,"&lt;/vb:"));Aq.find("span.axd-placeholder").not(":first").remove();Aq.find("iframe").remove();return Aq.html()}function AW(){var At=null,Ar=null,A6=null,A7="",A3="",A1="",Aw="";var A5=function(A8){if(!A8){A8=""}if(A8.match(/^https?:\/\//i)){return A8}if(A8.substr(0,1)=="/"){return pageData.baseurl+A8}return pageData.baseurl+"/"+A8};var As=function(BE,BA,BB,BD,A8,A9){A8=A8||[];console.log("createNavbarItem... Name: "+BA+" Url: "+BB+" NewWindow: "+BD+" UserGroups: "+A8+" itemAttr: "+A9);BA=JShtmlEncode(BA);var BC=AY("<li />").append("<label>{0}</label>".format(BA)).append(AY("<div />").addClass("nav-item-controls h-right").append('<i>|</i><span class="navbar-item-delete b-icon b-icon__trash b-icon--active" title="{0}"></span>'.format(vBulletin.phrase.get("delete"))).append('<i>|</i><span class="navbar-item-edit b-icon b-icon__pencil b-icon--active" title="{0}"></span>'.format(vBulletin.phrase.get("edit"))).append('<i>|</i><span class="navbar-item-opensubnav b-icon b-icon__arrow-right-m" title="{0}"></span>'.format(vBulletin.phrase.get("expand")))).data({"item-phrase":BE,"item-name":BA,"item-url":BB,"item-newwindow":BD,"item-usergroups":A8,"item-attr":A9});return BC};var Av=function(A8){return A8.prevAll("li").size()};var A2=function(){var A9=(Aw=="navbar"),A8=A9?AY("#channel-tabbar ul"):AY("#footer-tabbar ul.nav-list"),BA=A9?AY("#channel-subtabbar ul"):AY();A8.html("");BA.html("");var BB=function(BH,BF,BC){var BE=BF.data("item-newwindow")?' target="_blank"':"",BG=BF.hasClass("selected")&&BC?' class="current"':"",BD=AY("<li{0}><a {1}>{2}</a></li>".format(BG,BE,BF.data("item-name")));BD.find("a").prop("href",A5(BF.data("item-url")));BH.append(BD)};AY("#edit-navbar .navbar-ui-wrapper ul li").each(function(){var BC=AY(this);BB(A8,BC,A9);if(BC.hasClass("selected")){AY(BC.data("subnav-element")).find("li").each(function(){BB(BA,AY(this),true)})}})};var Au=function(BE,BG,A9,BA,BC,BF,BB){var A8=As(BE,BG,A9,BA,BC,BB);console.log("insertNavbarItem... Name: "+A8.data("item-name")+" Url: "+A8.data("item-url")+" NewWindow: "+A8.data("item-newwindow")+" UserGroups: "+A8.data("item-usergroups")+" itemAttr: "+A8.data("item-attr"));A8.appendTo(Ar);var BD=AY("<ul />").addClass("sub-navbar-list navbar-list sortable");AY(BF).each(function(){var BN=this.phrase?this.phrase:"",BI=this.title?this.title:"",BL=this.url?this.url:"",BM=this.newWindow?this.newWindow:false,BH=this.usergroups?this.usergroups:[],BK=this.attr?this.attr:"";var BJ=As(BN,BI,BL,BM,BH,BK);BJ.appendTo(BD)});(function(){var BH=null;BD.sortable({start:function(BI,BJ){BJ.placeholder.html(vBulletin.phrase.get("drop_page_here")).height(BJ.item.height()-2)},stop:function(BI,BJ){A2()},receive:function(BI,BJ){var BK=BJ.item.data("subnav-element")||AY();if(BK.is(":visible")){BJ.sender.sortable("cancel");vBulletin.warning("move_not_allowed","moving_main_nav_to_own_sub_nav_error")}else{if(BK.find("li").length>0){BJ.sender.sortable("cancel");vBulletin.warning("move_not_allowed","moving_main_nav_with_sub_nav_error")}}},connectWith:".sortable",placeholder:"sortable-highlight",forcePlaceholderSize:true}).disableSelection()})();BD.hide();BD.appendTo("#navbar-ui-container .subnavbar-list-container");A8.data("subnav-element",BD);A2()};var Ay=function(A9,BB,BC,BD,A8,BA){$newItem=As(A9.data("item-phrase"),BB,BC,BD,A8,BA);console.log("updateNavbarItem... Name: "+$newItem.data("item-name")+" Url: "+$newItem.data("item-url")+" NewWindow: "+$newItem.data("item-newwindow")+" itemAttr: "+$newItem.data("item-attr"));if(A9.data("subnav-element")){$newItem.data("subnav-element",A9.data("subnav-element"))}if(A9.hasClass("selected")){$newItem.addClass("selected")}A9.replaceWith($newItem);A2()};var A4=function(A9){Aw=A9;if(Aw=="navbar"){A7=AY("#channel-tabbar ul").html();A3=AY("#channel-subtabbar ul").html();A1=AY("#channel-tabbar ul li.current a").attr("href");AY("#channel-subtabbar.h-hide").toggleClass("h-hide default-hide")}else{A7=AY("#footer-tabbar ul.nav-list").html();A1=AY("#footer-tabbar ul.nav-list li.current a").attr("href")}AY("#admin-navbar-strip-gutter").removeClass().addClass("navbar-"+Aw);AY("#header").add("#header-axd").hide();AY("#navbar-ui-container").find(".navbar-ui-wrapper, .subnavbar-ui-wrapper").remove();var A8=AY("#edit-navbar");A8.find(".panel-header-text").hide();AY("#edit-navbar #panel-header-"+Aw).show();A8.slideDown("slow",function(){vBulletin.AJAX({call:"/ajax/api/site/"+(Aw=="navbar"?"loadHeaderNavbar":"loadFooterNavbar"),data:({siteId:1,edit:1}),success:function(BA){var BD=AY("<ul />").addClass("main-navbar-list navbar-list sortable "+Aw),BC=AY("<div />").addClass("new-nav-item main-nav").html(vBulletin.phrase.get("new_navigation_item")),BB=AY("<h4 />").text(vBulletin.phrase.get("main_navigation_bar"));AY("<div />").addClass("navbar-ui-wrapper").append(BB).append(BD).append(BC).appendTo("#navbar-ui-container");var BG=null;BD.sortable({start:function(BI,BJ){BJ.placeholder.html(vBulletin.phrase.get("drop_page_here")).height(BJ.item.height()-2)},stop:function(BI,BJ){A2()},connectWith:".sortable",placeholder:"sortable-highlight",forcePlaceholderSize:true}).disableSelection();Ar=BD;var BH=AY("<div />").addClass("subnavbar-list-container"),BF=AY("<div />").addClass("new-nav-item sub-nav").html(vBulletin.phrase.get("new_subnavigation_item")),BE=AY("<h4 />").text(vBulletin.phrase.get("sub_navigation_bar"));AY("<div />").addClass("subnavbar-ui-wrapper").append(BE).append(BH).append(BF).appendTo("#navbar-ui-container").hide();if(BA){console.log("result:",BA);AY(BA).each(function(){var BO=this.phrase?this.phrase:"",BJ=this.title?this.title:"",BM=this.url?this.url:"",BN=this.newWindow?true:false,BI=this.usergroups?this.usergroups:[],BL=this.subnav?this.subnav:[],BK=this.attr?this.attr:"";Au(BO,BJ,BM,BN,BI,BL,BK)})}AY("#edit-navbar .navbar-ui-wrapper ul li").first().find(".navbar-item-opensubnav").filter(":visible").click()},error_phrase:"error_retrieving_navigation_bar_configuration"})})};AY(document).on("vb-sitebuilder-panel--navbar",function(){var A8=AY(".js-top-menu-tab--navbar").get(0);if(AY("#edit-navbar").is(":hidden")){vBulletin.assertUserHasAdminPermission("canusesitebuilder",A8,function(){g.apply(A8);A4("navbar")})}return false});AY(document).on("vb-sitebuilder-panel--footer",function(){var A8=AY(".js-top-menu-tab--footer").get(0);if(AY("#edit-navbar").is(":hidden")){vBulletin.assertUserHasAdminPermission("canusesitebuilder",A8,function(){g.apply(A8);A4("footer")})}return false});var Aq=function(A8){AY("#navbar-edit-item").dialog({autoOpen:true,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:400,dialogClass:"dialog-container navbar-item-dialog-container",open:function(){AY("#navbar-edit-name").focus()}}).dialog("option","title",A8||vBulletin.phrase.get("edit_navigation_item")).dialog("open")};AY("#edit-navbar").on("click",".new-nav-item",function(){At=null;if(AY(this).closest(".navbar-ui-wrapper").size()>0){Ar=AY(this).closest(".navbar-ui-wrapper").find("ul")}else{Ar=AY(this).closest(".subnavbar-ui-wrapper").find("ul").filter(":visible")}AY("#navbar-edit-name").val("");AY("#navbar-edit-url").val("");AY("#navbar-edit-attr").val("");AY("#navbar-edit-newwindow").prop("checked",false);Aq(AY(this).html());return false});AY(document).on("click","#navbar-edit-save",function(){if(AY("#navbar-edit-name").val()==""){vBulletin.warning("edit_navigation_item","input_navigation_item_name",function(){AY("#navbar-edit-name").focus()})}else{if(AY("#navbar-edit-url").val()==""){vBulletin.warning("edit_navigation_item","input_target_url",function(){AY("#navbar-edit-url").focus()})}else{console.log("Saving new/edited navbar item");if(!At){Au("",AY("#navbar-edit-name").val(),AY("#navbar-edit-url").val(),AY("#navbar-edit-newwindow").prop("checked"),AY("#navbar-edit-item").data("edit-usergroups"),[],AY("#navbar-edit-attr").val())}else{Ay(At,AY("#navbar-edit-name").val(),AY("#navbar-edit-url").val(),AY("#navbar-edit-newwindow").prop("checked"),AY("#navbar-edit-item").data("edit-usergroups"),AY("#navbar-edit-attr").val())}At=null;Ar=null;AY("#navbar-edit-item").dialog("close");console.log("Done saving new/edited navbar item")}}return false});AY(document).on("click","#navbar-edit-cancel",function(){AY("#navbar-edit-item").dialog("close");return false});var Ax=false;AY(document).on("click","#navbar-edit-usergroups",function(){var A9=function(){var BD=AY("#navbar-edit-usergroups-dialog .select_all"),BA=AY("#navbar-edit-usergroups-dialog .navbar-usergroup-checkbox");BA.prop("checked",false);var BB=function(){var BE=(BA.filter(":checked").length==BA.length&&BA.eq(0).is(":checked"));BD.prop("checked",BE)};BA.off("change").on("change",BB);BD.off("change").on("change",function(){BA.prop("checked",AY(this).prop("checked"))});if(!At){return false}console.log("Prefilling checked usergroups");console.log(At.data("item-name"));console.log(At.data("item-url"));console.log(At.data("item-usergroups"));if(At.data("item-usergroups-temp")){var BC=At.data("item-usergroups-temp")}else{var BC=At.data("item-usergroups")}console.log(BC);AY.each(BC,function(BE,BF){AY("#navbar-usergroup-checkbox-"+BF).prop("checked",true)});BB()};var A8=function(){var BA=[];AY("#navbar-edit-usergroups-dialog .dialog-body input[type=checkbox]").each(function(){if(AY(this).prop("checked")){BA.push(AY(this).val())}});AY("#navbar-edit-item").data("edit-usergroups",BA);if(At){At.data("item-usergroups-temp",BA)}console.log("Saving checked usergroups")};if(!Ax){AY("#navbar-edit-usergroups-dialog").dialog({title:vBulletin.phrase.get("user_group_settings"),autoOpen:true,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:500,dialogClass:"dialog-container pagemap-dialog-container input-dialog",create:function(){AY("#navbar-edit-usergroups-dialog .cancel-button").on("click",function(){AY("#navbar-edit-usergroups-dialog").dialog("close")});AY("#navbar-edit-usergroups-dialog .save-button").on("click",function(){A8();AY("#navbar-edit-usergroups-dialog").dialog("close")});vBulletin.AJAX({call:"/ajax/api/usergroup/fetchUsergroupList",complete:function(){AY("body").css("cursor","auto")},success:function(BA){var BB=[];AY(BA).each(function(){BB.push('<div class="blockrow"><label><input type="checkbox" class="navbar-usergroup-checkbox" id="navbar-usergroup-checkbox-{0}" value="{0}"><span>{1}</span></label></div>'.format(this.usergroupid,this.title))});AY("#navbar-edit-usergroups-dialog .dialog-body").html(BB.join(""));AY("#navbar-edit-usergroups-dialog").dialog("option","position",{of:window});console.log("Done adding usergroups");A9()},error_phrase:"error_retrieving_list_user_groups",after_error:function(){AY("#navbar-edit-usergroups-dialog").dialog("close")}})},close:function(){},open:function(){A9()}});Ax=true}else{AY("#navbar-edit-usergroups-dialog").dialog("open")}return false});AY("#edit-navbar").on("click",".navbar-item-delete",function(){AY(this).closest("li").remove();A2();return false});AY("#edit-navbar").on("click",".navbar-item-edit",function(){var A8=AY(this).closest("li");console.log("Click to edit item... Name: "+A8.data("item-name")+" Url: "+A8.data("item-url")+" NewWindow: "+A8.data("item-newwindow")+" UserGroups: "+A8.data("item-usergroups"));At=A8;Ar=A8.closest("ul");At.data("item-usergroups-temp",null);AY("#navbar-edit-name").val(A8.data("item-name"));AY("#navbar-edit-url").val(A8.data("item-url"));AY("#navbar-edit-attr").val(A8.data("item-attr"));AY("#navbar-edit-newwindow").prop("checked",A8.data("item-newwindow"));Aq(AY(this).html());return false});AY("#edit-navbar").on("click",".navbar-item-opensubnav",function(){var BA=AY(this),BB=BA.closest("li"),A9=AY("#edit-navbar"),A8=A9.find(".subnavbar-ui-wrapper");console.log("Click to open item subnav ... Name: "+BB.data("item-name")+" Url: "+BB.data("item-url")+" NewWindow: "+BB.data("item-newwindow")+" UserGroups: "+BB.data("item-usergroups"));A9.find("li").removeClass("h-disabled selected");A9.find(".navbar-item-opensubnav").removeClass("b-icon--active");BB.addClass("selected");BA.addClass("b-icon--active");A8.find("ul").hide();AY(BB.data("subnav-element")).show();A8.show();A2();return false});AY(document).on("click",".navbar-navbar #admin-navbar-strip .lnkExitWithoutSaving, .navbar-footer #admin-navbar-strip .lnkExitWithoutSaving",function(){AY("#edit-navbar").slideUp();AY("#header").add("#header-axd").show();if(Aw=="navbar"){AY("#channel-tabbar ul").html(A7);AY("#channel-subtabbar ul").html(A3).parent(".default-hide").toggleClass("h-hide default-hide")}else{AY("#footer-tabbar ul.nav-list").html(A7)}});var Az=function(){var A8=[];AY("#edit-navbar .navbar-ui-wrapper ul li").each(function(){var BC=AY(this);var BA=function(BD){return{phrase:BD.data("item-phrase"),title:BD.data("item-name"),url:BD.data("item-url"),newWindow:BD.data("item-newwindow"),usergroups:BD.data("item-usergroups"),attr:BD.data("item-attr")}};var BB=[];BC.data("subnav-element").find("li").each(function(){$subLi=AY(this);BB.push(BA($subLi))});var A9=BA(BC);A9.subnav=BB;A8.push(A9)});vBulletin.AJAX({call:"/ajax/api/site/"+(Aw=="navbar"?"saveHeaderNavbar":"saveFooterNavbar"),data:({siteId:1,data:A8}),success:function(BA){AY("#edit-navbar").slideUp();AY("#header").add("#header-axd").show();AY("#admin-navbar-strip-gutter").addClass("h-hide");AY(document.body).removeClass("edit-mode lnkEditPage lnkNewPage lnkHeader lnkNavBar lnkFooter").addClass("view-mode");N(null,{enableButtons:true,currentButton:null});if(Aw=="navbar"){var A9=false;AY("#edit-navbar .navbar-ui-wrapper ul li").each(function(){var BB=AY(this);if(A5(BB.data("item-url"))==A5(A1)){A9=true;AY("#edit-navbar .navbar-ui-wrapper ul li").removeClass("selected");BB.addClass("selected");return false}});if(A9){A2()}else{AY("#channel-tabbar ul li").removeClass("current");AY("#channel-subtabbar ul").html("")}}},error_phrase:"error_saving_navigation_bar_configuration"})};var A0="#admin-navbar-strip .lnkSaveChanges";AY(document).on("click",".navbar-navbar "+A0+", .navbar-footer "+A0,function(){Az()})}function AO(){bindFormReset("#edit-page-dropdown form").trigger("reset",function(){AY("#save-content .template-name").addClass("h-hide");AY("input[type=hidden]",this).each(function(){this.value=this.defaultValue})});AY(".js-top-menu-sitebuilder--list .js-top-menu-link").removeClass("b-top-menu__item-link--disabled");AY(document).on("click","#sitebuilder-wrapper .lnkExitWithoutSaving",function(){if(AY(this).closest("#edit-page-dropdown").length==0){N(null,{enableButtons:true,currentButton:null})}});AY(document).on("vb-sitebuilder-panel--channels",function(){var Ax=AY(".js-top-menu-tab--channels").get(0);vBulletin.assertUserHasAdminPermission("canusesitebuilder",Ax,function(){g.apply(Ax);a(false);AY(".edit-mode .canvas-widget-list .canvas-widget").addClass("shadow");AY("#header, #header-axd, #save-content").hide();AY("#manage-page").show();AY("#edit-page-dropdown .lnkDeletePage").removeClass("h-hide");AY("#manage-page-dropdown").removeClass("h-hide").slideDown("slow",AH)});return false});function Av(){var Ax=AY(".js-sbpanel-pagelist-wrapper");Ax.find(".tab-item a").on("click",function(Ay){Ay.preventDefault()});Ax.tabs()}function Au(){var A0=AY(".js-sbpanel-pagelist-wrapper"),Ay=A0.find(".js-delayed-template-render-insert-here"),Az=A0.find(".js-loading-placeholder"),Ax={};A0.find(".js-simple-pagination-wrapper").each(function(){var A1=AY(this);Ax[A1.attr("id")]=A1.find(".js-pagenum").val()||0});A0.tabs("disable");Ay.html("");Az.removeClass("h-hide");vBulletin.AJAX({call:"/ajax/render/admin_sbpanel_pagelist_content_wrapper",data:{isAjaxTemplateRenderWithData:true},success:function(A1){Ay.html(A1.template);A0.tabs("refresh");A0.tabs("enable");A0.find(".js-simple-pagination-wrapper").each(function(){var A2=AY(this);At(A2,Ax[A2.attr("id")]);Aq(A2);Aw(A2)})},error_phrase:"error_fetching_dialog",complete:function(){Az.addClass("h-hide")}})}AY(document).on("vb-sitebuilder-panel--pages",function(){var Ax=AY(".js-top-menu-tab--pages").get(0),Ay=AY(".js-sbpanel-pagelist-wrapper");if(!Ay.data("panel-initialized")){Ay.data("tabspanel-initialized",true);Av()}vBulletin.assertUserHasAdminPermission("canusesitebuilder",Ax,function(){if(Ay.hasClass("h-hide")){g.apply(Ax);Ay.removeClass("h-hide").slideDown("slow");Au()}else{E.apply(Ax);Ay.slideUp("fast",function(){Ay.addClass("h-hide")})}});return false});AY(document).on("click",".js-sbpanel-pagelist-wrapper .js-button--close-panel",function(){var Ax=AY("#lnkPageList")[0],Ay=AY(".js-sbpanel-pagelist-wrapper");if(!Ay.hasClass("h-hide")){E.apply(Ax);Ay.slideUp("fast",function(){Ay.addClass("h-hide")})}});function Aq(Ay){var Ax=Ay.data("select-all-checkboxes-initialized")||false;if(Ax){console.log({msg:"Skipping checkbox init because it's already done.",$wrapper:Ay,});return }else{Ay.data("select-all-checkboxes-initialized",true)}Ay.find(".js-checkbox--checkall").each(function(){var Az=AY(this),A1=Az.data("group-id"),A3=Ay.find(".js-checkbox[data-group-id='"+A1+"']"),A2=A3.length,A0=A3;Az.on("change",function(A4){var A5=AY(this).prop("checked");Az.prop("indeterminate",false);if(A5){A3.prop("checked",true)}else{A3.prop("checked",false)}});A3.on("change",function(A4){var A6=AY(this).prop("checked"),A5=A3.filter(":checked").length;if(A2>A5){if(Az.prop("checked")&&A5>0){Az.prop("indeterminate",true)}Az.prop("checked",false)}else{Az.prop("indeterminate",false);Az.prop("checked",true)}})})}function Aw(Ay){var Ax=Ay.data("actions-initialized")||false;if(Ax){console.log({msg:"Skipping actions init because it's already done.",$wrapper:Ay,});return }else{Ay.data("actions-initialized",true)}Ay.find(".js-delete-orphaned-pagetemplates").on("click",function(Az){var A3=AY(this),A1=A3.data("group-id"),A0=Ay.find(".js-checkbox[data-group-id='"+A1+"']:checked"),A2={};A0.each(function(){A2[this.name]=AY(this).val()});if(A0.length<1){vBulletin.error("error","delete_orphaned_pagetemplates_please_select_one")}else{openConfirmDialog({title:vBulletin.phrase.get("delete"),message:vBulletin.phrase.get("delete_orphaned_pagetemplates_prompt_x",A0.length),iconType:"warning",onClickYes:function(){vBulletin.AJAX({call:"/ajax/api/page/deleteOrphanedPagetemplates",data:A0.serializeArray(),success:function(A4){console.log({msg:"/ajax/api/widget/deleteOrphanedPagetemplates success!",result:A4,});Au()}})}})}})}function At(A2,A3){var A0=A2.data("pagination-initialized")||false;if(A0){console.log({msg:"Skipping pagination init because it's already done.",$wrapper:A2,});return }else{A2.data("pagination-initialized",true)}var Ax=A2.find(".js-pagenav-goprev");var A4=A2.find(".js-pagenav-gopost");var Ay=A2.find(".js-pagenum");var A3=(A3&&parseInt(A3,10))||parseInt(Ay.val(),10);var A5=A2.find(".js-paginated-page");var A1={};var A6=0;A5.each(function(){A6++;A1[A6]=AY(this)});Ay.on("blur keyup",function(A8){if(A8.type=="blur"||A8.keyCode=="13"){var A7=parseInt(Ay.val(),10);Az(A7)}});Ax.on("click",function(A8){var A7=parseInt(Ay.val(),10);A7--;Az(A7)});A4.on("click",function(A8){var A7=parseInt(Ay.val(),10);A7++;Az(A7)});function Az(A7){if(A7<1){A7=1}if(A7>A6){A7=A6}A5.addClass("h-hide");if(A1[A7]){A1[A7].removeClass("h-hide")}Ay.val(A7)}Az(A3)}AY(document).on("vb-sitebuilder-panel--editpage",function(){var Ax=AY(".js-top-menu-tab--editpage").get(0);if(AY("#edit-page-dropdown-gutter").is(":hidden")){vBulletin.assertUserHasAdminPermission("canusesitebuilder",Ax,function(){function Ay(){y=false;Az();O();a(false,".container-widget");AY(".edit-mode .canvas-widget-list .canvas-widget").addClass("shadow");h.tabs("option","active",0);AY("#header, #header-axd, #save-content").hide();AY("#edit-content").show();AY("#edit-page-dropdown .lnkSaveChanges .label").text(vBulletin.phrase.get("save_page"));AY("#edit-page-dropdown .lnkDeletePage").removeClass("h-hide");AY("#edit-page-dropdown-gutter").removeClass("h-hide").slideDown("slow",S);AY(".canvas-widget.axd-widget .widget-content").each(function(){AY(this).html(b(AY(this).html(),vBulletin.phrase.get("ad")))})}function Az(){var A0=[];AY(".hidden-widget-placeholder").each(function(){A0.push(AY(this).attr("data-widget-instance-id"))});if(A0.length<1){return }vBulletin.AJAX({call:"/ajax/fetch-hidden-modules",data:({modules:A0}),complete:function(){Ay()},success:function(A1){if(A1.length>0){AY.each(A1,function(A2,A4){var A3=AY(A4.template).addClass("hidden-widget");AY('.hidden-widget-placeholder[data-widget-instance-id="'+A4.widgetinstanceid+'"]').replaceWith(A3)})}}})}g.apply(Ax);J(false,Ay)})}return false});AY(document).on("vb-sitebuilder-panel--newpage",function(){var Ax=AY(".js-top-menu-tab--newpage").get(0);if(AY("#edit-page-dropdown-gutter").is(":hidden")){vBulletin.assertUserHasAdminPermission("canusesitebuilder",Ax,function(){function Ay(){y=true;AY(".canvas-widget-list").empty();h.tabs("option","active",0);AY("#change-layout .layout-border.selected").removeClass("selected");AY("#layout-wide-narrow").prev().trigger("click");x=false;AY("#header, #header-axd, #save-content").hide();AY("#edit-content").show();AY("#edit-page-dropdown .lnkSaveChanges .label").text(vBulletin.phrase.get("save_new_page"));AY("#edit-page-dropdown .lnkDeletePage").addClass("h-hide");AY("#edit-page-dropdown-gutter").removeClass("h-hide").slideDown("slow",S)}g.apply(Ax);J(true,Ay)})}return false});var As=false;AY(document).on("vb-sitebuilder-panel--header",function(){var Ax=AY(".js-top-menu-tab--header").get(0);if(AY("#admin-navbar-strip-gutter").is(":hidden")){vBulletin.assertUserHasAdminPermission("canusesitebuilder",Ax,function(){g.apply(Ax);As=false;AY("#admin-navbar-strip-gutter").addClass("navbar-header").removeClass("h-hide").find(".prompt-text").text(vBulletin.phrase.get("select_edit_link_header"));var Ay=AY("#header"),Az=AY(".header-cell",Ay);$siteLogoEditStrip=AY("> .admin-only",Az).addClass("h-hide-imp"),w=Az.outerWidth();AY(".disable-overlay",Ay).width(Ay.innerWidth()-w).height(Ay.innerHeight()).show();$siteLogoEditStrip.width(w-(parseInt($siteLogoEditStrip.css("padding-left"),10)+parseInt($siteLogoEditStrip.css("padding-right"),10))).removeClass("h-hide-imp");AY(document).on("focus click mousedown",".edit-mode.lnkHeader #header .site-logo > a",function(A0){this.blur();A0.stopPropagation();return false})})}return false});AW();AY(".js-top-menu-sitebuilder").removeClass("h-hide");AY(document).on("click",".lnkHeader #admin-navbar-strip .lnkSaveChanges",function(){AY("body").css("cursor","wait");if(Number(AY("#header .site-logo img").attr("data-fileid"))>0){var Ax=As?function(){location.reload(true)}:null;AL(Ax)}else{if(As){location.reload(true)}else{AY("body").css("cursor","auto");AY("#admin-navbar-strip-gutter").addClass("h-hide").find(".prompt-text").text("");AY(document.body).removeClass("edit-mode lnkHeader").addClass("view-mode");AY("#header .disable-overlay").hide();N(null,{enableButtons:true,currentButton:null})}}});AY(document).on("click",".lnkHeader #admin-navbar-strip .lnkExitWithoutSaving",function(Ay){if(As){Ay.stopImmediatePropagation();location.reload(true);return false}else{var Ax=AY("#header .site-logo img");if(Ax.attr("src")!=Ax.attr("data-orig-src")){Ax.attr("src",Ax.attr("data-orig-src")).removeAttr("data-fileid")}AY("#admin-navbar-strip-gutter").find(".prompt-text").text("");AY("#header .disable-overlay").hide();N(null,{enableButtons:true,currentButton:null})}});AY(document).on("click","#admin-navbar-strip .lnkExitWithoutSaving",function(){AY("#admin-navbar-strip-gutter").addClass("h-hide");AY(document.body).removeClass("edit-mode lnkEditPage lnkNewPage lnkHeader lnkNavBar lnkFooter").addClass("view-mode");AY("#header").add("#header-axd").show();AY("#edit-navbar").hide();N(null,{enableButtons:true,currentButton:null})});AY("#header-axd .axdnum").change(function(){var Ax=AY(this),Ay=parseInt(Ax.val());window.vBulletin.loadingIndicator.show();vBulletin.AJAX({call:"/ajax/api/ad/saveNumberOfHeaderAds",data:{number:Ay},success:function(Az){if(Ay==1){AY("#header-axd").removeClass("axdnum_2").addClass("axdnum_1")}else{AY("#header-axd").removeClass("axdnum_1").addClass("axdnum_2")}},complete:function(){window.vBulletin.loadingIndicator.hide()}})});AY(document).off("click",".axd-edit-button").on("click",".axd-edit-button",function(){var Ay=AY(this).attr("data-location"),A3=AY(this).closest(".axd-container");if(A3.length==0){A3=AY('.axd-container[data-widget-instance-id="'+Ay+'"]')}A2();function A2(A4){A4=A4||false;vBulletin.AJAX({call:"/ajax/api/ad/listAdsByLocation",data:{adlocation:Ay},cache:false,success:function(A5){if(vBulletin.isEmptyList(A5)&&!A4){A0({adlocation:Ay});return }Az(A5)}})}function Az(A4){if(typeof k.axd_list_dialog=="undefined"){vBulletin.AJAX({call:"/ajax/render/dialog_axd_list",success:function(A5){k.axd_list_dialog=A5;AY("body").append(A5);Az(A4)},error_phrase:"error_fetching_dialog"});return }AY("#axd-list-dialog").dialog({title:vBulletin.phrase.get("manage_ads"),autoOpen:true,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:600,dialogClass:"dialog-container ad-list-dialog-container input-dialog",open:function(){var A5=AY(this),A7=[];var A8=function(){A5.dialog("close");A5.dialog("destroy")};for(var A6 in A4){A7.push([A4[A6].title,A4[A6].active,A4[A6].displayorder,A4[A6].adid])}AY(".title",A5).text(vBulletin.phrase.get("ad_list_description"));AY(".axdtable",A5).dataTable({bPaginate:false,bLengthChange:false,bInfo:false,bAutoWidth:false,bDestroy:true,aaSorting:[[2,"asc"]],aoColumns:[{sTitle:vBulletin.phrase.get("title")+"<span></span>",sClass:"axdtable-title axd-cell"},{sTitle:vBulletin.phrase.get("active"),sClass:"axdtable-active axd-cell",bSortable:false,bSearchable:false,fnRender:function(BA,A9){return'<input type="checkbox" class="isactive" data-id="{0}"{1} />'.format(BA.aData[3],((A9=="1")?' checked="checked"':""))}},{sTitle:vBulletin.phrase.get("display_order")+"<span></span>",sClass:"axdtable-display-order axd-cell",bSearchable:false,bUseRendered:false,fnRender:function(BA,A9){return'<input type="text" class="displayorder textbox" value="{0}" data-id="{1}" />'.format(BA.aData[2],BA.aData[3])}},{sTitle:vBulletin.phrase.get("action"),sClass:"axdtable-action axd-cell",bSearchable:false,bSortable:false,bUseRendered:false,fnRender:function(BA,A9){return'<a href="#" class="editlink" data-id="{0}" title="{1}"><span></span></a> <a href="#" class="deletelink" data-id="{0}" title="{2}"><span></span></a>'.format(BA.aData[3],vBulletin.phrase.get("edit"),vBulletin.phrase.get("delete"))}}],aaData:A7});AY(".dataTables_filter input[type=text]",A5).addClass("axdfilter textbox").on("keyup",function(){AY(this).next()[this.value!=""?"removeClass":"addClass"]("h-hide")}).after('<button type="button" class="axdSearchBtn b-button b-button--secondary b-button--sitebuilder h-hide">{0}</button>'.format(vBulletin.phrase.get("reset")));AY(".axdSearchBtn",A5).on("click",function(){AY(this).addClass("h-hide").prev().val("").trigger("keyup")});AY(".axdtable .editlink",A5).off("click").on("click",function(){var A9=AY(this).attr("data-id");A8();A0(A4[A9]);return false});AY(".axdtable .deletelink",A5).off("click").on("click",function(){var A9=AY(this).attr("data-id"),BA=AY(this).closest("tr").find(".isactive").prop("checked");A8();openConfirmDialog({title:vBulletin.phrase.get("confirm_deletion_x",A4[A9].title),message:vBulletin.phrase.get("are_you_sure_want_to_delete_ad_x",A4[A9].title,"adid",A9),iconType:"warning",onClickYes:function(){AY("body").css("cursor","wait");vBulletin.AJAX({call:"/ajax/api/ad/delete",data:{adid:A9},success:function(BB){A2(true);if(BA){As=true}}})},onClickNo:function(){A2()}});return false});AY(".axdlist",A5).show();AY(".btnAddAxd",A5).off("click").on("click",function(){A8();A0({adlocation:Ay});return false});AY(".btnCancelAxd",A5).off("click").on("click",function(){A8()});AY(".btnSaveAxd",A5).off("click").on("click",function(){if(AY(".isactive",A5).length==0){A8();return false}AY("body").css("cursor","wait");var A9={},BA=[];AY(".isactive",A5).each(function(){var BB=AY(this).attr("data-id");A9[BB]={};A9[BB]["displayorder"]=AY('.displayorder[data-id="'+BB+'"]',A5).val();if(AY(this).is(":checked")){A9[BB]["active"]=1;var BC=A9[BB];BC.snippet=A4[BB].snippet;BC.title=A4[BB].title;BA.push(BC)}else{A9[BB]["active"]=0}});vBulletin.AJAX({call:"/ajax/api/ad/quickSave",data:{data:A9},success:function(BB){var BC=AY(".axd_"+Ay,A3);if(BC.length==0){BC=AY(".widget-content",A3)}if(BA.length>0){BA.sort(function(BG,BF){return BG.displayorder-BF.displayorder});var BE="",BD="";AY.map(BA,function(BG,BF){if(BG.snippet){BD+=b(BG.snippet,BG.title);BE+=BG.snippet}});BC.html(BD);As=A1(BE)}else{BC.html("")}BC.show();A8();AY("html,body").animate({scrollTop:0},"slow")},complete:function(){AY("body").css("cursor","default")}})})}})}function A0(A4){vBulletin.AJAX({call:"/ajax/render/dialog_axd_config",data:{isAjaxTemplateRenderWithData:true},success:function(A5){k.axd_config_dialog=A5.template;AY("body").append(A5.template);Ax(A4)},error_phrase:"error_fetching_dialog"})}function Ax(A5){var A4=A5.adlocation;AY("#axd-config-dialog").dialog({title:vBulletin.phrase.get(A5.adid?["edit_ad_x",A5.title]:"create_ad"),autoOpen:true,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:720,dialogClass:"dialog-container axd-dialog-container input-dialog",open:function(){var A6=AY(this);if(A5.adid){AY(".title",A6).val(A5.title);AY(".axd_html",A6).val(A5.snippet);AY(".active",A6).prop("checked",(A5.active=="1"));AY(".axdid",A6).val(A5.adid);for(var A7 in A5.criterias){var A8=A5.criterias[A7],A9=A8.criteriaid;AY("[name=data\\[criteria\\]\\["+A9+"\\]\\[active\\]]",A6).prop("checked",true);AY("."+A9,A6).each(function(){var BC=AY(this),BB=BC.attr("name").match(/condition\d/);if(BB){BC.val(A8[BB[0]])}})}}else{AY(".axdid",A6).val(0);AY(".configform",A6).trigger("reset")}AY(".axd_location",A6).val(A4);AY(".blockrow select.custom-dropdown",A6).selectBox();AY(".blockrow a.custom-dropdown, .blockrow input[type=text]",A6).on("click",function(BB){return false});AY(".btnAttachHtmlAxd",A6).off("click").on("click",function(){var BB=AY(".configform",A6).serialize();AY("body").css("cursor","wait");vBulletin.AJAX({call:"/ajax/api/ad/save",data:BB,success:function(BC){BA();As=A1(AY(".configform .axd_html",A6).val())},complete:function(){AY("body").css("cursor","default")}})});AY(".btnCancelEditHtmlAxd",A6).off("click").on("click",function(){BA(true)});function BA(BB){BB=BB||false;AY(":checkbox",A6).prop("checked",false);AY("select",A6).val("");A6.dialog("close");A6.dialog("destroy");AY("#axd-config-dialog").remove();A2(BB)}}})}function A1(A6){var A5=AY("<div>"+A6+"</div>");if(A5.filter("script").length>0){return true}else{var A4=A5.find("*").filter(function(){return(this.nodeName.toLowerCase().indexOf("vb:")==0)?this:null});return(A4.length>0||(/\{vb\s*\:\s*[a-z]+\s+.*\}/).test(A6))}}return false});AY("#header .header-cell .js-edit-logo").on("click",function(){AY(".header-edit-box.selected").removeClass("selected");AY(this).closest(".header-edit-box").addClass("selected");AY("#edit-site-logo-dialog").dialog({title:vBulletin.phrase.get("edit_site_logo"),autoOpen:true,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:520,dialogClass:"dialog-container site-logo-dialog-container input-dialog",create:function(){var Ax=AY(this).closest(".ui-dialog").find(".ui-dialog-title");Ax.append('<span class="dialog-subtitle"></span>');Ax.children("span.dialog-subtitle").text(vBulletin.phrase.get("choose_options_site_logo"));AY("#btnCancelEditSiteLogo").on("click",function(){AY("#edit-site-logo-dialog").dialog("close")});AY("#btnSaveEditSiteLogo").on("click",function(){if(Number(AY("#header .site-logo img").attr("data-fileid"))>0){AL(function(){AY("#edit-site-logo-dialog").dialog("close")})}else{AY("#edit-site-logo-dialog").dialog("close")}});AY("#edit-site-logo-dialog .styleselection").change(function(){AY("#header .site-logo img").attr({"data-styleselection":AY(this).val()})});AY("#edit-site-logo-dialog").fileupload({dropZone:"vb-self",dataType:"json",add:function(Az,Ay){AY("body").css("cursor","wait");AY(Az.target).find(".js-upload-progress:first").removeClass("h-hide");Ay.submit()},done:function(Az,Ay){if(Ay.result&&Ay.result.filedataid){AY("#header .site-logo img").attr({src:Ay.result.imageUrl,"data-fileid":Ay.result.filedataid,"data-styleselection":AY("#edit-site-logo-dialog .styleselection:checked").val()})}else{vBulletin.error("error","error_uploading_logo")}},fail:function(Az,Ay){vBulletin.error("error","error_uploading_logo")},always:function(Az,Ay){AY("body").css("cursor","auto");AY(Az.target).find(".js-upload-progress:first").addClass("h-hide")}});AY("#edit-site-logo-dialog #btnAttachLogo").on("click",function(){var Ay=AY.trim(AY("#edit-site-logo-dialog #imageUrl").val());if(Ay){AY("body").css("cursor","wait");AY(this).closest(".dialog-content").find(".js-upload-progress:last").removeClass("h-hide");vBulletin.AJAX({call:"/uploader/Url",data:({urlupload:Ay}),complete:function(){AY("body").css("cursor","auto");AY("#edit-site-logo-dialog .js-upload-progress:last").addClass("h-hide")},success:function(Az){AY("#header .site-logo img").attr({src:Az.imageUrl,"data-fileid":Az.filedataid,"data-styleselection":AY("#edit-site-logo-dialog .styleselection:checked").val()})},title_phrase:"edit_site_logo",error_phrase:"error_processing_site_logo",after_error:function(){AY("#edit-site-logo-dialog #imageUrl").focus()}})}else{AY("#edit-site-logo-dialog #imageUrl").focus()}})}})});AY(".admin-button-flat").disableSelection();var Ar=function(Ax){Ao()};h=AY("#edit-content .tabs").tabs({beforeActivate:function(Ay,Az){AY("#save-content").hide();if(Az.newTab.index()==1){if(o){AY("#edit-page-dropdown .layout-list .layout-border.selected").removeClass("selected");var Ax=AY("#edit-page-dropdown .layout-list input[type=radio][value={0}]".format(AY(".canvas-layout:visible").attr("data-layout-id")));Ax.prev().addClass("selected");Ah="canvas-"+Ax.attr("id")}}},create:function(Ax,Ay){Ar(Ay.tab.index())},activate:function(Ax,Ay){Ar(Ay.newTab.index())}});AY("#lnkAddModules").on("click",function(){h.tabs("option","active",0);return false});AV();AY(document).on("click",".module-buttons .hide-icon input",function(){var Ay=AY(this);Ay.closest(".canvas-widget")[this.checked?"addClass":"removeClass"]("hidden-widget");var Ax=Ay.attr("title");Ay.attr("title",Ay.data("toggle-title")).data("toggle-title",Ax)});AY(".canvas-layout-container .canvas-layout").each(function(){AE[this.id]=AY("#"+this.id+' div[class*="section-"]').length});if(!y){Ah="canvas-"+AY("#edit-page-dropdown .layout-list input[type=radio][value={0}]".format(AY(".canvas-layout:visible").attr("data-layout-id"))).prop("checked",true).attr("id")}AI=AY("#edit-page-dropdown .layout-list input[type=radio]").thumbnailRadioCheckbox({thumbnailClass:"layout-border"});AI.thumbnailRadioCheckbox("option","select",function(Ay,Ax){AY(".canvas-layout").addClass("h-hide");AY("#canvas-"+Ax.attr("id")).removeClass("h-hide");C("canvas-"+Ax.attr("id"));Q();AD();x=true})}function C(At){if(!Ah){AY(".canvas-layout.h-hide input[type=hidden]").prop("disabled",true);AY("#"+At+" input[type=hidden]").prop("disabled",false);Ah=At;return }else{if(Ah==At){return }else{AY(".canvas-layout.h-hide input[type=hidden]").prop("disabled",true);AY("#"+At+" input[type=hidden]").prop("disabled",false);var Ar=AE[At];var Aq=false;var As=0;AY("#"+Ah+" > .canvas-layout-row > .canvas-widget-list").each(function(){var Ay=AY(this);Aq=AU(Ay,AY("#"+At+" > .canvas-layout-row > .canvas-widget-list"));if(!Aq.length){As=L(this);Aq=AY("#"+At+" > .canvas-layout-row > div.section-"+As)}if(!Aq.length){var Au=Ar;while(Au>=0&&AY("#"+At+" > .canvas-layout-row > div.section-"+Au).length==0){Au--}Aq=AY("#"+At+" > .canvas-layout-row > div.section-"+Au)}var Aw=Ay.children(".canvas-widget");var Az=parseInt(Math.ceil(Aw.length/Aq.length),10);console.log("Moving {0} widgets to {1} sections; ChunkSize {2}".format(Aw.length,Aq.length,Az));if(Az>0){var Ax=0,Av=0;Aw.each(function(){AY(this).appendTo(Aq.eq(Av));++Ax;if(Ax>=Az){Ax=0;++Av}})}})}}Ah=At}function AU(Aq,As){var Au=["js-sectiontype-notice","js-sectiontype-primary","js-sectiontype-secondary","js-sectiontype-extra"],Ar,At;for(Ar in Au){if(Aq.is("."+Au[Ar])){At=Au[Ar];break}}return As.filter(function(){return AY(this).is("."+At)})}function L(As){var Ar=/section-(\d+)/gi;var Aq=null;AY(AY(As).attr("class").split(" ")).each(function(Au,Av){var At=Ar.exec(Av);if(At&&!isNaN(At[1])){Aq=At[1]}});return Aq}function Ai(Aq){if(!AY.isArray(Aq)||Aq.length==0){return }vBulletin.AJAX({call:"/ajax/admin-template/widget",data:({widgets:Aq,pagetemplateid:AY("#save-page-form #pagetemplateid-yes").val()}),success:function(Ar){if(AY.isArray(Ar.widgets)){AY.each(Ar.widgets,function(As,Au){if(!Au.widgetid||Number(Au.widgetid)<1||!AY.trim(Au.template)){return true}var Av=(Au.displaysection&&Number(Au.displaysection)>0)?Au.displaysection:0,At=AY(Au.template);At.appendTo(AY(".canvas-layout:not(.h-hide) .canvas-widget-list.section-"+Av).height("auto")).filter(":not(.container-widget)").find(".toggle-button").trigger("click",[true]);At.find(".tabs").tabs()})}},error_phrase:"error_adding_widgets",});return false}function Ag(Aq,As){var At=Aq.closest(".channel-item-container").children(".sub-channel-container").children(".channel-item-container"),Ar=Aq.find(".b-icon");if(Ar.is(".b-icon__arrow-right-m")){Ar.removeClass("b-icon__arrow-right-m").addClass("b-icon__arrow-down-m");At.slideDown(150)}else{if(typeof (As)==="undefined"||!As){At.slideUp(150);Ar.addClass("b-icon__arrow-right-m").removeClass("b-icon__arrow-down-m")}}}function M(){AY(".channel-config-dialog .channel-list").sortable({placeholder:"main-channel-container-highlight drag-highlight h-clear",update:function(Aq,Ar){Ar.item.css("z-index","0");r.forum=true;AA=true},sort:function(Aq,Ar){},start:function(Aq,Ar){if(AY.browser.msie&&parseInt(AY.browser.version,10)==8){Ar.item.height(Ar.item.height()-4)}Ar.item.css("z-index","99999");Ar.placeholder.height(Ar.item.outerHeight())},over:function(Aq,Ar){},receive:function(Aq,Ar){},out:function(Aq,Ar){},handle:".grip-icon-main",items:".main-channel-container"})}function G(Aq){AG=Aq.find(".main-channel-container").sortable({connectWith:".sub-channel-container",placeholder:"channel-item-highlight drag-highlight",revert:true,update:function(Ar,As){var At=As.item.closest(".main-channel-container");if(As.sender&&As.sender.hasClass("main-channel-container")){if(AY("> .channel-item-container",As.sender).length==0){As.sender.slideUp("fast",function(){AY(this).remove()})}}r.forum=true;AA=true},sort:function(Ar,As){},activate:function(Ar,As){},start:function(Ar,As){},stop:function(Ar,As){AY(".main-channel-container, .sub-channel-container").height("auto")},over:function(Ar,As){},receive:function(Ar,As){},out:function(Ar,As){},handle:".channel-item-inner > .grip-icon-item",items:".channel-item-container"})}function W(Aq){AM=Aq.find(".sub-channel-container").sortable({connectWith:".sub-channel-container",revert:true,placeholder:"channel-item-highlight drag-highlight",update:function(Ar,As){if(As.sender&&As.sender.hasClass("main-channel-container")){if(AY("> .channel-item-container",As.sender).length==0){As.sender.slideUp("fast",function(){AY(this).remove()})}}r.forum=true;AA=true},sort:function(Ar,As){},start:function(Ar,As){},stop:function(Ar,As){AY(".main-channel-container, .sub-channel-container").height("auto")},over:function(As,At){var Ar=AY(this).closest(".channel-item-container").children(".channel-item").find(".toggle-button");Ag(Ar,true)},receive:function(Ar,As){},out:function(Ar,As){},handle:".channel-item-inner > .grip-icon-item",items:".channel-item-container"})}function Aj(Aq,At,Au,Av,Ay,A0,Ax){var Aw='<div class="'+(Ay?"category-to-channel":"channel-to-category")+'"><a href="#">'+vBulletin.phrase.get((Ay?"make_forum":"make_category"))+"</a></div>";var Az=AY(('<div class="main-channel-container">				<div class="grip-icon grip-icon-main h-left"><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div></div>				<div class="channel-item-container">					<div class="channel-item shadow" data-channel-id="{0}" data-parent-id="{2}">						<div class="channel-item-inner">							<div class="grip-icon grip-icon-item h-left"><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div></div>							<div class="channel-title"><div title="'+vBulletin.phrase.get("click_text_edit_title")+'">{1}</div><input type="text" name="channeltitle" value="{1}" /></div>							<div class="close-button" title="'+vBulletin.phrase.get("remove_forum")+'">x</div>							<div class="toggle-button"><div class="b-icon b-icon__arrow-right-m"></div></div>							<div class="num-subchannels">'+Ax+'</div>							<div class="add-subchannel-button h-right" title="'+vBulletin.phrase.get("add_subforum")+'"><a href="#">+</a></div>							'+Aw+'							<div class="h-clear"></div>						</div>					</div>					<div class="sub-channel-container"></div>				</div>		 </div>').format(At,Av,Au)).appendTo(Aq);if(A0){var Ar=AY("#top-level-forum .channel-config-dialog .channel-list");var As=Ar.find(".main-channel-container").last();AY("html, body").animate({scrollTop:As.offset().top},"fast")}r.forum=true;AA=true;return Az}function AS(As,At,Au,Ax,Ar,Aw){var Av='<div class="'+(Ax?"category-to-channel":"channel-to-category")+'"><a href="#">'+vBulletin.phrase.get((Ax?"make_forum":"make_category"))+"</a></div>";var Ay=Ar.hasClass("main-channel-container")?AY("> .channel-item-container > .sub-channel-container",Ar):AY("> .sub-channel-container",Ar);var Aq=AY(('<div class="channel-item-container">				<div class="channel-item shadow" data-channel-id="{0}" data-parent-id="{2}">					<div class="channel-item-inner">						<div class="grip-icon grip-icon-item h-left"><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div></div>						<div class="channel-title"><div title="Click text to edit title">{1}</div><input type="text" name="channeltitle" value="{1}" /></div>						<div class="close-button" title="'+vBulletin.phrase.get("remove_forum")+'">x</div>						<div class="toggle-button"><div class="b-icon b-icon__arrow-right-m"></div></div>						<div class="num-subchannels">'+Aw+'</div>						<div class="add-subchannel-button h-right" title="'+vBulletin.phrase.get("add_subforum")+'"><a href="#">+</a></div>						'+Av+'						<div class="h-clear"></div>					</div>			 </div>			 <div class="sub-channel-container"></div>			</div>').format(As,Au,At)).hide().appendTo(Ay);r.forum=true;AA=true;return Aq}function Ad(){vBulletin.AJAX({call:"/ajax/fetch-widget-admin-template-list",complete:function(){Ao();AY(window).resize(Ao)},success:function(As){AJ=true;if(AY.isArray(As)){if(As.length>0){var At={},Aw=0;AY.each(As,function(Ay,Az){if(!Az.widgetid||Number(Az.widgetid)<1){return true}Aw++;if(!At[Az.category]){At[Az.category]={count:1,title:Az.category_title}}else{At[Az.category].count++}var Ax=AY("#edit-page-dropdown .module-list .module-icon-template").clone();Ax.attr("data-widget-id",Az.widgetid).attr("data-title",AY.trim(Az.title).toLowerCase()).data("canbemultiple",Az.canbemultiple).removeClass("module-icon-template").addClass(("module-item category-{0}"+(Az.cloneable=="1"?" module-cloneable":"")).format(Az.category));AY(".module-icon",Ax).html(AY("<img />").attr("src",pageData.baseurl+"/images/sitebuilder/"+AY.trim(Az.icon)).attr("height",60).attr("width",60).attr("alt",vBulletin.phrase.get("module_icon")));AY(".module-title .main-title",Ax).html(AY.trim(Az.title));Ax.appendTo("#edit-page-dropdown .module-list").removeClass("h-hide")});AY(('<div class="category-arrow-left h-left" title="'+vBulletin.phrase.get("previous")+'">&lsaquo;</div>							<div class="scroller category h-left">								<div class="categories h-left">									<div id="category-all" class="category selected">'+vBulletin.phrase.get("all")+' ({0})</div>									<div id="category-result" class="category h-hide">'+vBulletin.phrase.get("search_results")+' (<span></span>)</div>								</div>							</div>							<div class="category-arrow-right h-left" title="'+vBulletin.phrase.get("next")+'">&rsaquo;</div>							<div class="h-clear"></div>').format(Aw)).insertBefore("#edit-page-dropdown .module-list-container .scroller");var Ar=0;AY.each(At,function(Ay,Az){var Ax=AY('<div id="category-{0}" class="category">{1} ({2})</div>'.format(Ay,Az.title,Az.count)).insertBefore("#category-result");Ar+=Ax.outerWidth(true)});var Av=Ar+AY("#category-all").outerWidth(true);AY(".categories").width(Av);if(AY(".categories").width()<=AY(".scroller.category").width()){AY(".category-arrow-left, .category-arrow-right").css("visibility","hidden")}else{AY(".category-arrow-right").css("visibility","visible")}Ap();e=AY("#edit-page-dropdown .module-list .module-item").not(".non-module-item");e.draggable({connectToSortable:".canvas-layout-row > .canvas-widget-list:visible",helper:"clone",revert:"invalid",appendTo:"#add-modules .module-list-container",zIndex:2000,start:function(Ax,Ay){if(AY(this).data("canbemultiple")=="0"&&AY("#content .canvas-layout .canvas-widget[data-widget-id={0}]".format(AY(this).attr("data-widget-id"))).length>0){vBulletin.warning("move_not_allowed",["adding_multiple_modules_not_allowed",AY(".main-title",this).html()]);return false}z=true},stop:function(Ax,Ay){z=false}}).disableSelection();var Aq=false;AY("#search-module-keyword").on("keyup",function(Ax,A5){var A4=AY("#add-modules"),A1=AY("#category-result"),Ay=AY(".categories",A4),Az=AY(".scroller.category",A4),A0=false;AY(".module-item",A4).hide();if(!A5){AY(".category.selected",A4).removeClass("selected")}var A3=AY.trim(this.value.toLowerCase());if(A3){AY('.module-item[data-title*="{0}"]'.format(A3),A4).show();A1.removeClass("h-hide").addClass("selected")}else{AY(".module-item",A4).show();AY("#category-all").removeClass("h-hide").addClass("selected");A1.addClass("h-hide").removeClass("selected");A0=true}var A6=AY(".module-item:visible",A4).length;AY("span",A1).text(A6);Ap();if(A6==0){AY(".empty-module",A4).show()}else{AY(".empty-module",A4).hide()}if(A0){Ay.width(Av)}else{Ay.width(Av+A1.outerWidth(true))}if(Ay.width()<=Az.width()){AY(".category-arrow-left, .category-arrow-right",A4).css("visibility","hidden");Az.scrollLeft(0)}else{if(A0){AY(".category-arrow-left",A4).css("visibility","hidden");AY(".category-arrow-right",A4).css("visibility","visible");Az.scrollLeft(0)}else{AY(".category-arrow-left",A4).css("visibility","visible");AY(".category-arrow-right",A4).css("visibility","hidden");var A2=Az.get(0);Az.scrollLeft(A2.scrollWidth-A2.clientWidth)}}return true});AY("#add-modules .categories .category").on("click",function(Az){Az.stopPropagation();if(AY(this).hasClass("selected")){return false}var Ax=AY(this).closest(".module-list-container"),A0=AY(".module-item",Ax);AY(".category.selected",Ax).removeClass("selected");AY(this).addClass("selected");A0.hide();AY(".empty-module",Ax).hide();var Ay=this.id;if(Ay=="category-all"){A0.show();AY(".non-module-item",Ax).hide()}else{if(Ay=="category-result"){AY("#search-module-keyword").triggerHandler("keyup",[true])}else{AY(".module-item.{0}".format(Ay),Ax).show()}}Ap();return false}).disableSelection();var Au;AY(".category-arrow-left").on({mousedown:function(){AY(".category-arrow-right").css("visibility","visible");Au=setInterval(function(){var Ax=AY(".scroller.category");Ax.scrollLeft(Ax.scrollLeft()-20);if(Ax.scrollLeft()==0){AY(".category-arrow-left").css("visibility","hidden");clearInterval(Au)}},50)},mouseup:function(){clearInterval(Au)}}).disableSelection();AY(".category-arrow-right").on({mousedown:function(){AY(".category-arrow-left").css("visibility","visible");Au=setInterval(function(){var Ay=AY(".scroller.category");Ay.scrollLeft(Ay.scrollLeft()+20);var Ax=Ay.get(0);if(Ay.scrollLeft()==Ax.scrollWidth-Ax.clientWidth){AY(".category-arrow-right").css("visibility","hidden");clearInterval(Au)}},50)},mouseup:function(){clearInterval(Au)}}).disableSelection()}else{AY('<div class="empty-module">'+vBulletin.phrase.get("no_modules")+"</div>").appendTo("#edit-page-dropdown .module-list")}}},error_phrase:"error_retrieving_modules",})}function p(Ar,Aq){vBulletin.AJAX({call:"/ajax/api/widget/fetchWidgetGuidToWidgetidMap",success:function(As){if(As.map){AR=As.map}else{AR={error_result:As}}if(typeof Ar=="function"){Ar.apply(this,Aq)}}})}function s(){AY("#edit-page-dropdown .template-list").empty();vBulletin.AJAX({call:"/ajax/api/pagetemplate/fetchPageTemplateList",data:{pagetemplateid:AY("#save-page-form #pagetemplateid-yes").val()},success:function(Ar){AC=true;if(AY.isArray(Ar)&&Ar.length>0){var Aq=false;AY.each(Ar,function(As,At){AY('<div class="template-item">								<input type="radio" id="pagetemplateid-{0}" name="pagetemplateid" value="{0}" data-thumbnail="{1}/images/sitebuilder/icon-layout-{4}.png"{2} />								<label class="label">{3}</label>							</div>'.format(At.pagetemplateid,pageData.baseurl,(!y&&AY("#save-page-form #pagetemplateid-yes").val()==At.pagetemplateid)?' checked="checked"':"",At.title,At.screenlayoutvarname)).appendTo("#edit-page-dropdown .template-list").data({screenlayoutid:At.screenlayoutid,widgetinstances:At.widgetinstances});if(AY("#save-page-form #pagetemplateid-yes").val()==At.pagetemplateid){Aq=true;if(At.title==""){window.console.warn("The page template for this page does not have a title.")}}});if(!y&&!Aq){window.console.error("The page template for this page was not in the list returned by fetchPageTemplateList! Expected pagetemplateid: {0}. Please ensure that this page template has a title.".format(AY("#save-page-form #pagetemplateid-yes").val()))}AY(".template-item",AY("#edit-page-dropdown .template-list")).each(function(As){AY(this).attr("data-title",AY(".label",AY(this)).text().toLowerCase())});AY("#search-template-keyword").on("keyup",function(Aw){if(Aw.keyCode==13){Aw.preventDefault();return false}var At=AY("#select-template"),Ax=AY(".scroller",At),Av=false;AY(".template-item",At).hide();var As=AY.trim(this.value.toLowerCase());if(As){AY('.template-item[data-title*="{0}"]'.format(As),At).show()}else{AY(".template-item",At).show();Av=true}var Au=AY(".template-item:visible",At).length;Ap();AY(".empty-template",At).toggle(Au==0);return true});AY("#search-template-keyword").on("keydown",function(As){if(As.keyCode==13){As.preventDefault();return false}});d=AY("#edit-page-dropdown .template-list .template-item input[type=radio]").thumbnailRadioCheckbox({thumbnailClass:"template-border",preselect:function(At,As){if(As.is(":checked")){return false}if(x||AA){openConfirmDialog({title:vBulletin.phrase.get("switch_template"),message:vBulletin.phrase.get("template_changes_will_be_lost"),iconType:"warning",onClickYes:function(){x=false;AA=false;o=true;d.thumbnailRadioCheckbox("check",As,true)}});return false}o=true;return true},select:function(Aw,As){AY(".canvas-layout").addClass("h-hide");var Au=As.closest(".template-item").data("screenlayoutid");AY(".canvas-layout[data-layout-id="+Au+"]").removeClass("h-hide");Q();AD();AY("#save-page-form #pagetemplateid-yes, #config_pagetemplateid").val(As.val());AY("#save-page-form .page-template-name").html(vBulletin.phrase.get("page_template_name_id",As.closest(".template-item").find(".label").html(),As.val()));if(o){AY(".canvas-widget-list").empty();var At=As.closest(".template-item").data("widgetinstances");if(AY.isArray(At)&&At.length>0){var Av=[];AY.each(At,function(Ax,Ay){Av.push({widgetid:Ay.widgetid,widgetinstanceid:Ay.widgetinstanceid})});Ai(Av,true);O()}else{window.vBulletin.loadingIndicator.hide()}}AY("body").removeClass("lnkNewPage").addClass("lnkEditPage");AY("#save-page-form .new-page-template input").prop("disabled",true);AY("#save-page-form .edit-page-template input").prop("disabled",false);o=true},unselect:function(){}});Ap()}},})}function AL(Aq){vBulletin.AJAX({call:"/uploader/setlogo",data:({filedataid:AY("#header .site-logo img").attr("data-fileid"),styleselection:AY("#header .site-logo img").attr("data-styleselection")}),complete:function(){AY("body").css("cursor","auto")},success:function(Ar){if(AY.trim(Ar)==="true"){AY("#header .site-logo img").removeAttr("data-styleselection").removeAttr("data-fileid").attr("data-orig-src",AY("#header .site-logo img").attr("src"));AY("#admin-navbar-strip-gutter").addClass("h-hide").find(".prompt-text").text("");AY(document.body).removeClass("edit-mode lnkHeader").addClass("view-mode");AY("#header .disable-overlay").hide();N(null,{enableButtons:true,currentButton:null});if(typeof Aq=="function"){Aq()}}},error_phrase:"error_saving_site_logo"})}function P(Aq,Ar){AY.each(Aq,function(At,As){var Au=AY(('<div class="sub-channel channel" data-channel-id="{0}" data-parent-id="{6}">				<div class="avatar h-left"></div>				<div class="title"><a href="{1}{2}">{3}</a></div>				<div class="info">					<span class="label">'+vBulletin.phrase.get("last_post")+':</span>					<span class="title">{4}</span>				</div>				<div class="h-clear"></div>').format(As.nodeid,pageData.baseurl,As.url,As.title,(As.lastPostTitle?As.lastPostTitle:"<em>"+vBulletin.phrase.get("none")+"</em>"),pageData.baseurl_core,As.parentid)).appendTo(Ar);P(Aq[At].subchannels,Au.eq(0))})}function AK(Ar,Aq){AY.each(Ar,function(As,Au){var At=AY.map(Au.subchannels,function(Ax,Aw){return Aw}).length;var Av=AS(Au.nodeid,Au.parentid,Au.title,Au.category,Aq,At);AK(Au.subchannels,Av)})}function Ab(){h.tabs("option","active",0);var Aw=AY("#add-modules").height();h.tabs("option","active",1);var Aq=AY("#change-layout").height();h.tabs("option","active",2);var Ar=AY("#select-template").height();AY("#edit-page-dropdown .lnkSaveChanges").trigger("click");var At=AY("#save-page-form").height();h.tabs("option","active",0);var Av=Math.max(Aw,Aq,Ar,At);var As=AY("#edit-page-dropdown .panel-header-text");As.each(function(){var Ax=AY(this);Ax.css("min-height",Av-parseFloat(Ax.css("margin-top"))-parseFloat(Ax.css("margin-bottom"))-parseFloat(Ax.css("padding-top"))-parseFloat(Ax.css("padding-bottom")))});var Au=AY("#edit-page-dropdown .panel-main-content");Au.each(function(){var Ax=AY(this);Ax.css("min-height",Av-parseFloat(Ax.css("margin-top"))-parseFloat(Ax.css("margin-bottom"))-parseFloat(Ax.css("padding-top"))-parseFloat(Ax.css("padding-bottom")))})}function a(Aq,Ar){var As=(Ar&&Ar.length>0)?AY(".canvas-layout .canvas-widget").not(Ar).find(".widget-content"):AY(".canvas-layout .canvas-widget .widget-content");if(Aq){As.each(function(){if(AY(this).is(":hidden")){AY(this).closest(".canvas-widget").find(".widget-header .toggle-button").trigger("click",[true])}})}else{As.each(function(){if(!AY(this).is(":hidden")){AY(this).closest(".canvas-widget").find(".widget-header .toggle-button").trigger("click",[true])}})}}function n(Ar,Aq){if(Aq){if(Ar.find(".widget-content").is(":hidden")){Ar.find(".toggle-button").trigger("click",[true])}}else{if(!Ar.find(".widget-content").is(":hidden")){Ar.find(".toggle-button").trigger("click",[true])}}}function O(){if(!y){var Aq=AY(".canvas-layout:visible .canvas-widget.subchannel-widget");if(Aq.length==1){Aq.find(".close-button").hide()}else{Aq.find(".close-button").show()}}}function An(As,Aq){var Ar=As.attr("data-widget-id");if(AB[Ar]==null){vBulletin.AJAX({call:"/ajax/fetch-widget-template",data:({widgetid:Ar}),success:function(At){var Av=AY.trim(At);if(Av){var Au=AY(Av.replace(/\<\s*script[^\>]*\>(.*?)\<\s*\/\s*script\>/g,""));Au.attr("data-title",function(){var Aw=AY(".module-title",Au).clone();Aw.find(".hide-on-viewmode").children().unwrap();Aw.find("*:hidden").remove();return AY.trim(Aw.text()).toLowerCase()});AB[Ar]=Au;if(typeof Aq=="function"){Aq(Au.clone(true))}}},error_phrase:"error_retrieving_cloned_widget_template",})}else{if(typeof Aq=="function"){Aq(AB[Ar].clone(true))}}}function F(Aq,Ar){AY(".edit-mode .canvas-widget.youtube-widget .widget-content").css("visibility",Aq);if(Ar){Ar.find(".widget-content").css("visibility",(Aq=="hidden"?"visible":"hidden"))}}function D(Aq){var At="js-sb-module-config--viewpermissions--template";if(!At.length){return""}if(!Aq.hasOwnProperty("defaultvalue")){Aq.defaultvalue={show:"all",}}var Ax=AY("."+At).clone().removeClass(At+" h-hide"),Az=Aq.defaultvalue,Ay=(Az.hasOwnProperty("hide")?"hide":"show"),Av=(Ay=="show"&&typeof Az[Ay]=="string"&&Az[Ay]=="all"),Ar=Ax.find("input.js-module_viewpermissions__key[value='show_all']"),Aw=Ax.find("input.js-module_viewpermissions__key[value='show']"),As=Ax.find("input.js-module_viewpermissions__key[value='hide']"),Au=Ax.find(".js-module_viewpermissions_ugchecklist");if(Ay=="hide"){Ay="show";Av=true;Ar.prop("checked",false);Aw.prop("checked",true)}if(Ay=="hide"){Ar.prop("checked",false);Aw.prop("checked",false);As.prop("checked",true)}else{if(Av){Ar.prop("checked",true);Aw.prop("checked",false);As.prop("checked",false);Au.addClass("h-hide")}else{Ar.prop("checked",false);Aw.prop("checked",true);As.prop("checked",false)}}if(!Av){AY.each(Az[Ay],function(A0,A1){Au.find("input.js-module_viewpermissions__value[value='"+A1+"']").prop("checked",true)})}Ax.find("input.js-module_viewpermissions__key").on("change",function(A0){if(this.value=="show_all"){Au.addClass("h-hide")}else{Au.removeClass("h-hide")}});return Ax}function Z(Ar){var At="js-sb-module-config--filter_nodes--template";if(!At.length){return""}if(!Ar.hasOwnProperty("defaultvalue")){Ar.defaultvalue={include:["all"],}}var A2=AY("."+At).clone().removeClass(At+" h-hide"),A4=Ar.defaultvalue,A3=(A4.hasOwnProperty("exclude")?"exclude":"include"),As=A4.hasOwnProperty("include_children")?A4.include_children:true,A1=A2.find("input[name='data[module_filter_nodes][include_children]']"),A5=A2.find("input.js-module_filter_nodes__key[value='include']"),A0=A2.find("input.js-module_filter_nodes__key[value='exclude']"),Av=A2.find("select.js-module_filter_nodes-values"),Aq=A2.find("input[name='data[module_filter_nodes][selection_type]']"),Az=A2.find("*[data-disable-on='exclude']"),Ax=A2.find("*[data-disable-on='include']"),Au=function(A7,A8){var A6=Av.data("selectBox-control")||{};A7.each(function(){var A9=AY(this);A9.attr("disabled","disabled");if(A9.is("option")&&A6.length>0){A6.find("li:has(> a[rel='"+A9.val()+"'])").removeClass("selectBox-selected").addClass("selectBox-disabled")}});A8.each(function(){var BA=AY(this);BA.removeAttr("disabled");if(BA.is("option")&&A6.length>0){var A9="";if(BA.is(":selected")){A9="selectBox-selected"}A6.find("li:has(> a[rel='"+BA.val()+"'])").removeClass("selectBox-disabled").addClass(A9)}})},Ay=A2.find("*[data-hide-on='exclude']"),Aw=A2.find("*[data-hide-on='include']");Aq.on("change vb-init",function(A6){var A8=AY(this),A9=A8.val(),A7=Av.data("selectBox-control")||{};if(!A8.is(":checked")){return }if(A9=="all"||A9=="current"){Av.attr("disabled","disabled");if(A7.length>0){A7.addClass("selectBox-disabled")}}else{Av.removeAttr("disabled");if(A7.length>0){A7.removeClass("selectBox-disabled")}}});A2.find("input.js-module_filter_nodes__key").on("change",function(A6){if(this.value=="exclude"){Au(Az,Ax);Ay.hide();Aw.show()}else{Au(Ax,Az);Aw.hide();Ay.show()}});if(A3=="exclude"){A5.prop("checked",false);A0.prop("checked",true);A0.change()}else{A0.prop("checked",false);A5.prop("checked",true);A5.change()}if(!A4.hasOwnProperty(A3)){A4.key=[]}else{if(typeof A4[A3]=="string"||typeof A4[A3]=="number"){A4[A3]=[A4[A3]]}}AY.each(A4[A3],function(A6,A7){if(A7==="all"){Aq.filter("[value='all']").prop("checked",true);return false}else{if(A7==="current"){Aq.filter("[value='current']").prop("checked",true);return false}else{Aq.filter("[value='custom']").prop("checked",true);Av.find("option[value='"+A7+"']").prop("selected",true)}}});Aq.trigger("vb-init");A1.prop("checked",As);return A2}function AV(){AY(document).off("click",".canvas-widget.default-widget:not(.js-search-widget) .edit-button").on("click",".canvas-widget.default-widget:not(.js-search-widget) .edit-button",function(){var Ax=AY(this).closest(".canvas-widget"),Ar=Ax;var As=AY("> .widget-header .module-title",Ax);(function(){var Ay=Ax.data("widget-instance-id");if(vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+Ay]){if(AY("#sb-temp-module-cache").length==0){AY('<div id="sb-temp-module-cache" class="h-hide"></div>').appendTo("body")}var Az=AY(vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+Ay]);if(Az.find(".widget-tabs").length>0||Az.is(".widget-tabs")){AY("#sb-temp-module-cache").append(Az);delete vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+Ay]}}var A0=AY("#sb-temp-module-cache .canvas-widget").filter(function(){return AY(this).data("widget-instance-id")==Ay});if(A0.length==1&&(A0.find(".widget-tabs").length>0||A0.is(".widget-tabs"))){Ax=A0}})();if(Ax.is(".js-search-widget")){return }var Au=Ax.attr("data-widget-id");var At;if(AY("span.admin-only",As).length>0){At=AY("span.admin-only",As).text()}else{At=AY(".hide-on-viewmode",As).length>0?AY(".hide-on-viewmode",As).text():As.text()}var Aw=Ax.data("widget-type")||"";AY("#config-dialog .loader").show();AY("#config-dialog .widget-name h1").html(At);AY("#config-dialog .dialog-content .widget-config-container").hide().empty().removeClass("error notice");AY("#config-dialog").data("selected-module",Ar);F("hidden");AY("#config-dialog").dialog("open");var Av=Ar.attr("data-widget-instance-id")||"";vBulletin.AJAX({call:"/ajax/api/widget/fetchConfigSchema",data:({widgetid:Au,widgetinstanceid:Av,pagetemplateid:Y(),configtype:"admin"}),success:function(BE){AY("#config_widgetid").val(BE.widgetid);AY("#config_widgetinstanceid").val(BE.widgetinstanceid);f(BE.pagetemplateid);Ar.attr("data-widget-instance-id",BE.widgetinstanceid);if(!Av){T(Ar)}var BF=AY("#config-dialog .dialog-content .widget-config-container");if(!BE.configs||BE.configs.length==0){AY("#config-dialog .widget-config-container").html(vBulletin.phrase.get("no_configurations_found")).addClass("notice");AY("#btnSaveConfig").prop("disabled",true);AY("#btnCloseConfig").focus()}else{var BG=0;AY('<input type="hidden" name="data[widget_type]" />').addClass("widget-type").val(Aw).appendTo(BF);var BL=false,A0=false,BA=false,A4=false,BN,BM=false,A9=Ar.data("is-tabbed-container"),BB={display_tabs:false,default_tab:false},A8=(AY("#debug-information").length==1),A7=vBulletin.isRtl();AY.each(BE.configs,function(BZ,BS){var BR=null;switch(BS.type){case"Text":var BT=typeof (BS.defaultvalue!="undefined")?BS.defaultvalue:"";BR=AY('<input type="text" name="data[{0}]" id="data[{0}]" />'.format(BS.name)).addClass("textbox config-textbox").val(BT);break;case"LongText":var BT=typeof (BS.defaultvalue!="undefined")?BS.defaultvalue:"";BR=AY('<textarea name="data[{0}]" id="data[{0}]" rows="3" />'.format(BS.name)).addClass("textbox config-textbox").val(BT);break;case"YesNo":var BX={option_1:AY('<input type="radio" value="1" name="data[{0}]" id="data[{0}_1]" />'.format(BS.name)),label_1:AY("<label />").attr({"for":"data["+BS.name+"_1]"}).text(vBulletin.phrase.get("yes")),option_0:AY('<input type="radio" value="0" name="data[{0}]" id="data[{0}_0]" />'.format(BS.name)),label_0:AY("<label />").attr({"for":"data["+BS.name+"_0]"}).text(vBulletin.phrase.get("no"))};var Bd=BX["option_"+BS.defaultvalue];if(Bd){Bd.prop("checked",true)}BR=AY("<div />").append(BX.option_1,BX.label_1,BX.option_0,BX.label_0);break;case"Checkboxes":BR=AY("<div />");AY.each(BS.data,function(Bf,Bh){var Bg="";if(BS.defaultvalue&&typeof BS.defaultvalue[Bf]!="undefined"&&BS.defaultvalue[Bf]==1){Bg=' checked="checked"'}var Bi=AY('<div><label><input type="checkbox" name="data[{0}][{1}]"{2} value="1" class="js-checkbox-always-send" /> {3}</label></div>'.format(BS.name,Bf,Bg,Bh));BR.append(Bi)});break;case"Select":BM=true;BR=AY('<select name="data[{0}]" />'.format(BS.name));var BW;if(BS.data!=""){for(BW in BS.data){if(BS.defaultvalue==BW){AY("<option />").attr("value",BW).attr("selected","selected").text(BS.data[BW]).appendTo(BR)}else{AY("<option />").attr("value",BW).text(BS.data[BW]).appendTo(BR)}}}break;case"ChannelSelect":BM=true;BR=AY('<select name="data[{0}]" />'.format(BS.name));var Bb=AY('<optgroup label="{0}" />'.format(vBulletin.phrase.get("special_options"))),BU=AY('<optgroup label="{0}" />'.format(vBulletin.phrase.get("channels"))),Ba=false,Bc=false;if(BS.data){AY.each(BS.data,function(Bf,Bg){var Bh=null;if(BS.defaultvalue==Bg.nodeid){Bh=AY("<option />").attr("value",Bg.nodeid).attr("selected","selected").html(Bg.text)}else{Bh=AY("<option />").attr("value",Bg.nodeid).html(Bg.text)}if(Bg.nodeid<1){Bh.appendTo(Bb);Ba=true}else{Bh.appendTo(BU);Bc=true}});if(Ba){Bb.appendTo(BR)}if(Bc){BU.appendTo(BR)}}break;case"ContentTypeSelect":BM=true;BR=AY('<select name="data[{0}]" />'.format(BS.name));var Bb=AY('<optgroup label="{0}" />'.format(vBulletin.phrase.get("special_options"))),BY=AY('<optgroup label="{0}" />'.format(vBulletin.phrase.get("content_types"))),Ba=false,BV=false;if(BS.data){AY.each(BS.data,function(Bf,Bh){var Bg=null;if(BS.defaultvalue==Bh.value){Bg=AY("<option />").attr("value",Bh.value).attr("selected","selected").html(vBulletin.phrase.get(Bh.phrase))}else{Bg=AY("<option />").attr("value",Bh.value).html(vBulletin.phrase.get(Bh.phrase))}if(Bh.special){Bg.appendTo(Bb);Ba=true}else{Bg.appendTo(BY);BV=true}});if(Ba){Bb.appendTo(BR)}if(BV){BY.appendTo(BR)}}break;case"ProfileFieldSelect":BM=true;BR=AY('<select name="data[{0}]" />'.format(BS.name));if(BS.data){AY.each(BS.data,function(Bf,Bh){var Bg=null;if(BS.defaultvalue==Bh.field){Bg=AY("<option />").attr("value",Bh.field).attr("selected","selected").html(Bh.title)}else{Bg=AY("<option />").attr("value",Bh.field).html(Bh.title)}Bg.appendTo(BR)})}break;case"Slider":BR=(function(Bl){var Bg,Bf,Bo=0,Bp=0,Bk=1,Bi=0.1,Bh="",Bm="",Bn="";if(Bl.defaultvalue){Bo=Bl.defaultvalue}if(Bl.data&&typeof Bl.data=="object"){var Bj=Bl.data;if(Bj.hasOwnProperty("min")){Bp=parseFloat(Bj.min)}if(Bj.hasOwnProperty("max")){Bk=parseFloat(Bj.max)}if(Bj.hasOwnProperty("interval")){Bi=parseFloat(Bj.interval)}if(Bj.hasOwnProperty("leftlabel")&&Bj.leftlabel){Bn+='<span class="h-left">'+Bj.leftlabel+"</span>"}if(Bj.hasOwnProperty("rightlabel")&&Bj.rightlabel){Bn+='<span class="h-right">'+Bj.rightlabel+"</span>"}if(Bn!=""){Bn='<div class="config-slider-label">'+Bn+'<div class="h-clear"></div></div>'}}Bh='data-min="{0}" data-max="{1}" data-interval="{2}"'.format(Bp,Bk,Bi);Bm=Bn+'<div class="js-module-config-slider config-slider" '+Bh+" >"+'	<input type="hidden" name="data[{0}]" value="{1}" />'.format(Bl.name,Bo)+"</div>";Bg=AY(Bm);return Bg})(BS);break;case"ChannelIncludeExclude":BR=Z(BS);BM=true;break;case"Custom":switch(BS.name){case"tab_data":BR=AY("<div />");var Be=i(Ar),BQ=AY("<div />");AY.each(Be,function(Bi,Bf){var Bg="[tab_data]["+Bi+"][title]",Bh=Bf.title,Bj=AY('<input type="text" name="data{0}" id="data{0}" />'.format(Bg)).addClass("textbox config-textbox").attr("value",Bh);BR.append(Bj);AY.each(Bf.widgets,function(Bk,Bl){AY.each(Bl,function(Bn,Bm){Bg="[tab_data]["+Bi+"][widgets]["+Bk+"]["+Bn+"]";Bh=Bm;Bj=AY('<input type="text" name="data{0}" id="data{0}" />'.format(Bg)).addClass("textbox config-textbox").attr("value",Bh);BR.append(Bj)})})});break;case"module_viewpermissions":BR=D(BS);break;default:break}break;default:console.log("hit default");return ;break}$requiredMark=AY("<div />").addClass("config-required-mark h-left").append(function(){return(BS.isRequired==1)?"*":"&nbsp;"});if(BS.isEditable==0&&BR){BR.find("input").prop("readonly",true);if(!BR.is("input")){BR.prop("disabled",true)}}var BP=AY("<div />").addClass("config-label h-left").addClass(BS.name).html(BS.label);if(A8){BP.prop("title",BS.name)}if(BS.description){AY("<div />").addClass("config-description").html(BS.description).appendTo(BP)}if(BS.ishiddeninput){if(BR){BR.attr("hidden",true);BF.append(BR)}}else{BF.append(AY("<div></div>").addClass(function(){return"h-clearfix config-row"+(((++BG)%2!=0)?" odd":"")}).append(BP,$requiredMark,AY("<div></div>").addClass("config-value h-left").addClass(BS.name).append(BR)))}if(BS.name=="default_tab"){if(A9){BB.default_tab=BS}else{BL=true}}if(BS.name=="display_tabs"){if(A9){BB.display_tabs=BS}else{A0=true}}if(BS.name=="tab_order"){if(!A9){BA=true}}if(BS.name=="axd"){A4=true}});var BK=null;var A1=function(){BN=Aq(Ax);var BS=Ax.attr("data-widget-default-tab"),BQ=AY('select[name="data[default_tab]"]',BF),BR;BQ.empty();for(var BP in BN){if(A0){if(!AY('input:checkbox[value="'+BN[BP].selector+'"]',BH).is(":checked")){continue}}else{if(!BN[BP].displayed){continue}}BR=AY('<option value="'+BN[BP].selector+'">'+BN[BP].label+"</option>");if(BK&&BK==BN[BP].selector){BR.attr("selected","selected")}else{if(BS==BN[BP].selector){BR.attr("selected","selected")}}BQ.append(BR)}};var BI=function(){BN=Aq(Ax);var BQ=AY(".config-value.tab_order",BF),BR,BS;BQ.empty().append("<ul>");for(var BP in BN){if(A0){if(!AY('input:checkbox[value="'+BN[BP].selector+'"]',BH).is(":checked")){continue}}else{if(!BN[BP].displayed){continue}}BR=AY('<li id="'+BN[BP].selector+'">'+BN[BP].label+"</li>");AY("ul",BQ).append(BR);BS=AY('<input name="data[tab_order]['+BN[BP].selector.substring(1)+']" value="'+BP+'" type="hidden">');BQ.append(BS)}AY("ul",BQ).sortable({stop:function(){var BT=AY(this).sortable("toArray");BQ.find("input:hidden").remove();for(BP in BT){BS=AY('<input name="data[tab_order]['+BT[BP].substring(1)+']" value="'+BP+'" type="hidden">');BQ.append(BS)}}});AY("ul",BQ).disableSelection()};if(A0){BN=Aq(Ax);var BH=AY(".config-value.display_tabs",BF),A3;for(var BJ in BN){A3=AY('<label><input type="checkbox" name="data[display_tabs][]" value="'+BN[BJ].selector+'">'+BN[BJ].label+"</label>");if(BN[BJ].displayed){A3.find("input:checkbox").attr("checked","checked")}BH.append(A3)}if(BL){AY("input:checkbox",BH).on("click",function(){A1();BI()})}}if(BA){BI();AY('select[name="data[default_tab]"]',BF).change(function(){BK=AY(this).val()})}if(BL){A1()}var Az=v(Ar);if(Az){AY("<input type='hidden' name='data[containerinstanceid]' value='"+Az+"' />").appendTo(BF)}if(A9){var A6=i(Ar),A2=AY('select[name="data[default_tab]"]',BF),BO=AY(".config-value.display_tabs",BF),Ay=BB.display_tabs&&BB.display_tabs.defaultvalue||"";if(Ay==""){Ay={};AY.each(A6,function(BQ,BP){Ay[BQ]="1"})}var BD=function(){var BP;A2.empty();AY.each(A6,function(BR,BQ){BP=AY('<option value="'+BR+'">'+BQ.title+"</option>");if(Ay[BR]=="0"){BP.prop("disabled",true)}else{if(BB.default_tab.defaultvalue==BR){BP.attr("selected","selected")}}A2.append(BP)});if(A2.is(".selectBox")){A2.selectBox("refresh")}};if(BB.default_tab){BD()}if(BB.display_tabs){var A5;BO.empty();AY.each(Ay,function(BR,BQ){var BP="data[display_tabs]["+BR+"]";A5=AY("<label />").append(AY('<input type="hidden" name="'+BP+"\" value='0'/>")).append(AY('<input type="checkbox" name="'+BP+"\" value='1' data-tab-number=\""+BR+'" />')).append(document.createTextNode(A6[BR]["title"]));if(BQ=="1"){A5.find("input:checkbox").prop("checked",true)}BO.append(A5)});AY("input:checkbox",BO).on("click",function(){var BT=AY(this),BQ=BT.prop("checked"),BS=BT.data("tab-number"),BP=A2.find("option[value='"+BS+"']"),BR=(BP.prop("disabled")!=!BQ);Ay[BS]=BQ;if(BR){BD()}})}}if(A4){var BC=AY(".config-value.axd",BF);BC.append('<button class="axd-edit-button b-button b-button--secondary b-button--sitebuilder" data-location="'+BE.widgetinstanceid+'">'+vBulletin.phrase.get("edit")+"</button>")}}BF.show();AY("#config-dialog .loader").hide();if(BM){BF.find("select").selectBox()}BF.find(".js-module-config-slider").each(function(BR){var BQ=AY(this),BV=BQ.find("input"),BU=BQ.parent().find(".js-slider-output"),BT=BQ.data("min"),BP=BQ.data("max"),BS=BQ.data("interval");if(BV.length){BQ.slider({min:BT,max:BP,step:BS,value:BV.val(),isRTL:A7,change:function(BW,BX){var BY=BX.value;if(BU.length){BU.val(BY)}BV.val(BY)},})}});(function(){function BP(){var BQ=AY(this),BR=BQ.next(".js-checkbox-always-send-hidden");if(BR.length==0&&!BQ.prop("checked")){AY('<input type="hidden" name="{0}" class="js-checkbox-always-send-hidden" value="0" />'.format(BQ.prop("name"))).insertAfter(BQ)}else{BR.remove()}}AY(".js-checkbox-always-send").off("click").on("click",BP);AY(".js-checkbox-always-send").each(BP)})();AY("#config-dialog .dialog-content .widget-config-container input,						#config-dialog .dialog-content .widget-config-container textarea,						#config-dialog .dialog-content .widget-config-container select,						#config-dialog .dialog-content .widget-config-container button").filter(function(){return AY(this).is(":visible")}).first().focus()},error_phrase:["error_retrieving_configuration",At],after_error:function(){AY("#config-dialog .loader").hide();AY("#config-dialog").dialog("close")},});return false});function Aq(As){var Ar=[];AY("ul.widget-tabs-nav li a, .widget-header ul.ui-tabs-nav li a, .widget-tabs-nav ul.ui-tabs-nav li a",As).each(function(){var At=AY(this),Au;if(AY(this).closest("li").hasClass("h-hide")){Au=false}else{Au=true}Ar.push({selector:At.attr("href"),label:At.text(),displayed:Au})});return Ar}}function Q(){AY(".edit-mode .canvas-layout:visible > .canvas-widget-list").width("").each(function(){AY(this).width(AY(this).width())})}function AD(){if(AY.browser.msie&&parseInt(AY.browser.version,10)==8){var Aq=AY(".edit-mode .canvas-layout:visible > .canvas-widget-list");Aq.each(function(){var Ar=AY(".canvas-widget",this),Ax=AY(this);var As=Ar.outerHeight(true)||50;var At=Ar.length*Ar.outerHeight(true);var Aw=Ax.height()-At;console.log("offset:",Aw);if(Aw>=0&&Aw<As){var Av=AY(window);var Au=Av.scrollTop();Ax.height(Ax.height()+(As-Aw));Av.scrollTop(Au);return false}else{if((Aw>As&&Ax.height()>parseInt(Ax.css("min-height"),10))||Aw<0){var Av=AY(window);var Au=Av.scrollTop();Ax.height(At+As);Av.scrollTop(Au);return false}}})}}function AN(){window.console.log("Fetching page manager forums (initializeForumEditor)");vBulletin.AJAX({call:"/ajax/api/widget/fetchPageManagerForums",complete:function(){AY("#config-dialog .loader").hide()},success:function(Aq){H=true;var As=AY("<div>").addClass("channel-list");AY.each(Aq,function(Au,Aw){var Av=AY.map(Aw.subchannels,function(Ay,Ax){return Ax}).length;var At=Aj(As,Aw.nodeid,Aw.parentid,Aw.title,Aw.category,false,Av);AK(Aw.subchannels,At)});var Ar=AY("#top-level-forum .channel-config-dialog");Ar.find(".channel-list").remove();G(As);W(As);Ar.append(As);AY(document).on("mousedown",".main-channel-container > .channel-item-container > .channel-item .grip-icon",function(){AY(this).closest(".main-channel-container").height(AY(this).closest(".main-channel-container").height())});AY(document).on("mousedown",".sub-channel-container > .channel-item-container > .channel-item .grip-icon",function(){AY(this).closest(".sub-channel-container").height(AY(this).closest(".sub-channel-container").height())});AA=false;M()},error_phrase:"error_fetching_channels"});AY(document).on("click keydown",".channel-config-dialog .add-channel-fieldset .add-button, .channel-config-dialog .add-channel-fieldset input",function(Aq){if(((Aq.type=="click"||Aq.which!=13)&&this.type=="text")||(Aq.type=="keydown"&&this.type=="button"&&Aq.which!=13)){return true}var At=(this.type=="text")?AY(this):AY(this).prev();var Ar=AY.trim(At.val());if(Ar&&Ar!=At.prop("defaultValue")){var As=AY("#top-level-forum .channel-config-dialog .channel-list");Aj(As,"","",vBulletin.htmlEntities(Ar),0,true,0);G(As);M();At.val("");if(this.type=="button"){At.focus()}}else{vBulletin.warning("warning_gcpuser","please_enter_channel_title",function(){At.focus()})}});AY(document).on("click",".channel-config-dialog .main-channel-container .channel-item .channel-title div",function(){AY(this).hide();var Aq=AY(this).next();Aq.show();Aq.select();Aq.focus()});AY(document).on("keydown blur",".channel-config-dialog .main-channel-container .channel-item .channel-title input",function(Aq){if(Aq.type=="focusout"||(Aq.type=="keydown"&&Aq.which==13)){if(!AY.trim(this.value)&&Aq.type=="focusout"){this.value=this.defaultValue}if(AY.trim(this.value)){AY(this).hide();AY(this).prev().text(this.value);AY(this).prev().show()}}});AY(document).on("click",".channel-config-dialog .channel-item .category-to-channel a",function(){var Aq=AY(this).closest(".channel-item");Aq.attr("data-switch-category",0);AY(this).parent().removeClass("category-to-channel").addClass("channel-to-category");AY(this).html(vBulletin.phrase.get("make_category"));return false});AY(document).on("click",".channel-config-dialog .channel-item .channel-to-category a",function(){var Aq=AY(this).closest(".channel-item");Aq.attr("data-switch-category",1);AY(this).parent().removeClass("channel-to-category").addClass("category-to-channel");AY(this).html(vBulletin.phrase.get("make_forum"));return false});AY(document).on("click",".channel-config-dialog .channel-item .toggle-button",function(){Ag(AY(this));return false});AY(document).on("click",".channel-config-dialog .channel-item .add-subchannel-button a",function(){var Aq=AY(this).parent().siblings(".toggle-button");Ag(Aq,true);var As=AY(this).closest(".channel-item-container");var Ar=AS("","",vBulletin.phrase.get("new_channel"),0,As,0);W(As);Ar.slideDown(100,function(){var At=As.find(".channel-item-inner").first().find(".num-subchannels");At.text(parseInt(At.text())+1);AY(".channel-title div",Ar).click();AY(".channel-title input",Ar).get(0).scrollIntoView(false);M()});return false});AY(document).on("click",".channel-config-dialog .channel-list .channel-item .close-button",function(){var Ar=AY(this),As=AY("> .sub-channel-container > .channel-item-container",Ar.closest(".channel-item-container")).length>0,Aq=vBulletin.htmlEntities(Ar.prev().text());openConfirmDialog({title:vBulletin.phrase.get("remove_forum_q"),message:vBulletin.phrase.get("do_you_want_to_remove_forum",Aq,(As)?" "+vBulletin.phrase.get("subchannels_will_be_deleted"):""),iconType:"warning",onClickYes:function(){var Aw=Ar.closest(".channel-item-container"),Av=Aw.parent(),Au=Ar.closest(".channel-item").attr("data-channel-id");var At=function(){Aw.remove();if(Av.hasClass("main-channel-container")){Av.slideUp("fast",function(){AY(this).remove()})}};if(Au){vBulletin.AJAX({call:"/ajax/api/content_channel/delete",data:{nodeid:Au},success:function(Ax){At()},})}else{At()}}})})}function Am(Ar){function Aq(At,Au,As){vBulletin.AJAX({call:"/ajax/render/{0}_list".format(At),data:{page:Au,isAjaxTemplateRenderWithData:true},complete:function(){AY("#config-dialog .loader").hide();AY("body").css("cursor","auto")},success:function(Av){AY(("#top-level-{0} .channel-config-dialog").format(At)).html(Av.template);if(As){vBulletin.pagination({context:("#top-level-{0} .channel-config-dialog").format(At),onPageChanged:function(Aw,Ax){Aq(At,Aw)}})}},error_phrase:"error_fetching_channels"})}Aq(Ar,1,true);AY(document).on("click",".page_manager_table .channel_name div",function(){AY(this).hide();var As=AY(this).next();As.show();As.select();As.focus()});AY(document).on("keydown blur",".page_manager_table .channel_name input",function(Au){if(Au.type=="focusout"||(Au.type=="keydown"&&Au.which==13)){if(!AY.trim(this.value)&&Au.type=="focusout"){this.value=this.defaultValue}var At=AY.trim(this.value),As=AY(this);if(At&&As.prev().html()!=At){AY("body").css("cursor","wait");vBulletin.AJAX({call:"/ajax/api/Content_Channel/update",data:{nodeid:As.parents(".channel_row").data("nodeid"),data:{title:At}},complete:function(){AY("#config-dialog .loader").hide();AY("body").css("cursor","auto")},success:function(Av){As.hide();As.prev().html(At);As.prev().show()},error_phrase:"error_saving_page"})}}});AY(document).on("click",".page_manager_table .delete",function(){var As=AY(this);openConfirmDialog({title:vBulletin.phrase.get("remove_channel_q"),message:vBulletin.phrase.get("do_you_want_to_remove_channel",As.parents(".channel_row").find(".channel_name_val").text()),iconType:"warning",onClickYes:function(){vBulletin.AJAX({call:"/ajax/api/content_channel/delete",data:{nodeid:As.parents(".channel_row").data("nodeid")},success:function(At){As.parents(".channel_row").remove()}})}})})}var H=false;function AH(){AY("body").css("cursor","wait");var Aq=function(As){var Ar=As.index();if(Ar==0&&!H){AN()}if((Ar==1||Ar==2)){Am(AY(As.context).data("top-level"))}};q=AY("#manage-pages").tabs({beforeActivate:function(At,Au){var As=Au.newTab.index();if(As!=0&&AA){var Ar=openConfirmDialog({title:vBulletin.phrase.get("exit_without_saving_page"),message:vBulletin.phrase.get("forum_changes_will_be_lost"),iconType:"warning",onClickYes:function(){AA=false;q.tabs("option","active",As)}});return false}},create:function(Ar,As){Aq(As.tab)},activate:function(Ar,As){Aq(As.newTab)}});q.tabs("option","active",0);AY("#manage-page-dropdown .lnkSaveChanges").on("click",function(){console.log("Saving forum/channel data");var Ar=AY(this);if(Ar.hasClass("h-disabled")){console.log("We're busy saving already. Try again later.");return }Ar.addClass("h-disabled");vBulletin.loadingIndicator.show();AY("body").css("cursor","wait");var As=[];function At(Aw,Au,Av){var Ax=AY("> .channel-item-container",Aw);if(Ax.length>0){Ax.each(function(Az){var Ay=AY("> .channel-item",this);var A0=Ay.attr("data-channel-id");var A1=Ay.attr("data-parent-id");subchannelObj={nodeid:A0||"0",previousParentId:A1,title:AY(".channel-title div",Ay).html(),displayorder:Az+1,parentid:Av||"0",subchannels:[]};if(Ay.attr("data-switch-category")!=null){subchannelObj.switchCategory=Ay.attr("data-switch-category")}Au.subchannels.push(subchannelObj);At(Ay.next(".sub-channel-container"),Au.subchannels[Az],A0)})}}if(r.forum){AY(".channel-config-dialog .channel-list .main-channel-container").each(function(Aw){var Av=AY("> .channel-item-container > .channel-item",this);var Ax=Av.attr("data-channel-id");var Ay=Av.attr("data-parent-id");var Au={nodeid:Ax,previousParentId:Ay,title:AY(".channel-title div",Av).html(),displayorder:Aw+1,subchannels:[]};if(Av.attr("data-switch-category")!=null){Au.switchCategory=Av.attr("data-switch-category")}At(Av.next(".sub-channel-container"),Au,Ax);As.push(Au)});vBulletin.AJAX({call:"/ajax/api/widget/saveForums",data:{data:JSON.stringify(As)},complete:function(){AY("body").css("cursor","auto");vBulletin.loadingIndicator.hide();Ar.removeClass("h-disabled")},success:function(Au){console.log("Forum/channel changes successfully saved");if(Au&&Au.forums&&Au.forums.length>0){AA=false;r.forum=false;location.reload(true)}else{openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("error_saving_forums"),iconType:"error"});return false}},error_phrase:"error_saving_channels_code"})}else{console.log("No forum/channel changes to save");vBulletin.loadingIndicator.hide();AY("body").css("cursor","auto");Ar.removeClass("h-disabled")}});AY(document).on("click","#manage-page-dropdown .lnkExitWithoutSaving",function(){if(AA){openConfirmDialog({title:vBulletin.phrase.get("exit_without_saving_page"),message:vBulletin.phrase.get("do_you_want_to_exit_without_saving_page"),iconType:"warning",onClickYes:function(){location.reload(true)}})}else{location.reload(true)}})}function S(){AY(document).on("focus click",".edit-mode .widget-content a, .edit-mode #channel-tabbar a, .edit-mode #btnSearch, .edit-mode #q",function(Ax){this.blur();return false});if(!AJ){Ad()}if(!AC){s()}else{d.thumbnailRadioCheckbox("check",AY("#select-template .template-border.selected").next("input"),false);if(!y){AY("#select-template .template-item input[value={0}]".format(AY("#pagetemplateid-yes").val())).prev().trigger("click")}}if(AY.isEmptyObject(AR)){p()}Ap();AY("#config_pagetemplateid").val("");u=undefined;if(y){AY("#save-page-form #pagetitle").val("");AY("#save-page-form #pageurl").val("");AY("#save-page-form #pagetemplateid").val("0");AY("#save-page-form #pageid").val("0");AY("#save-page-form #ishomeroute").prop("disabled",false).prop("checked",false)}AY("#edit-page-dropdown .lnkDeletePage").on("click",function(){openConfirmDialog({title:vBulletin.phrase.get("confirm_deletion_gcpglobal"),message:vBulletin.phrase.get("confirm_remove_page_desc"),buttonLabel:{yesLabel:vBulletin.phrase.get("delete_page"),noLabel:vBulletin.phrase.get("cancel")},iconType:"warning",onClickYes:function(){vBulletin.AJAX({call:"/ajax/api/page/delete",data:{pageid:pageData.pageid},dataType:"json",complete:function(){AY("body").css("cursor","auto")},success:function(Ax){console.log("deleted page "+pageData.pageid);window.location.href=pageData.baseurl},error:function(Az,Ay,Ax){console.log("page delete  failed! result:"+Ax);openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("error_deleting_page",Az.status),iconType:"error"})}})}})});AY("#edit-page-dropdown .lnkSaveChanges").on("click",function(){AY("#edit-page-dropdown .tabs li").removeClass("ui-tabs-active ui-state-active");AY("#edit-page-dropdown .tabs .tab").addClass("ui-tabs-hide");AY("#save-content").show();AY("#save-page-form .edit-page-template").css("display","");AY("#save-page-form .edit-page-template").prev("label").css("display","");if(AY("body").hasClass("lnkNewPage")){AY("#save-page-form .new-page-template input").prop("disabled",false);AY("#save-page-form .edit-page-template input").prop("disabled",true)}else{if(!AY("#pagetemplateid-yes").prop("checked")&&!AY("#pagetemplateid-no").prop("checked")){AY("#pagetemplateid-yes").prop("checked",true)}AY("#save-page-form .edit-page-template input").prop("disabled",false);AY("#save-page-form .new-page-template input").prop("disabled",true);if(y&&(!x&&!AA)){AY("#save-page-form .edit-page-template").css("display","none");AY("#save-page-form .edit-page-template").prev("label").css("display","none")}if(AY("#pagetemplateid-yes").prop("checked")){AY("#save-page-form #templatetitle").prop("disabled",false);AY("#save-page-form #templatetitle-edit").prop("disabled",true);AY("#save-page-form .page-template-name").removeClass("h-hide")}else{AY("#save-page-form #templatetitle").prop("disabled",true);AY("#save-page-form #templatetitle-edit").prop("disabled",false);AY("#save-page-form .page-template-name").addClass("h-hide")}}});AY(document).on("click","#edit-page-dropdown .lnkExitWithoutSaving",function(){if(x||AA||o||(!y&&(AY("#pagetitle").val()!=AY("#pagetitle").prop("defaultValue")||AY("#pageurl").val()!=AY("#pageurl").prop("defaultValue")))||(y&&(AY("#pagetitle").val()!=""||AY("#pageurl").val()!=""))){openConfirmDialog({title:vBulletin.phrase.get("exit_without_saving_page"),message:vBulletin.phrase.get("do_you_want_to_exit_without_saving_page"),iconType:"warning",onClickYes:function(){var Ax=parseInt(AY("input#pagetemplateid-new").val(),10);if(!isNaN(Ax)&&Ax>0){vBulletin.AJAX({call:"/ajax/api/page/deleteOrphanedPagetemplates",data:{pagetemplateids:[Ax]},success:function(Ay){console.log({msg:"/ajax/api/widget/deleteOrphanedPagetemplates success!",result:Ay,})},complete:function(){location.reload(true)},})}else{location.reload(true)}}})}else{location.reload(true)}});var Aq=0;AY(window).on("resize.canvas",function(){clearTimeout(Aq);Aq=setTimeout(Q,200)});var At=function(Ax){return'<label class="hide-icon module-button-item"><input type="checkbox" title="{0}" data-toggle-title="{1}"{2} /></label>'.format(vBulletin.phrase.get("check_to_hide_module"),vBulletin.phrase.get("uncheck_to_unhide_module"),Ax?' checked="checked"':"")};AY(".canvas-widget.container-widget .canvas-widget:not(.dummy-widget)").each(function(){var Ax=AY(this).hasClass("hidden-widget");AY(".module-buttons .admin-only",this).prepend(At(false));if(Ax){AY(".module-buttons .admin-only .hide-icon input",this).trigger("click")}});var Aw=function(Az,A0,A2){var A1=A0.item,A2=A0.item.hasClass("module-item");var Ax=AY("> .canvas-widget.container-widget {0}".format(A2?".module-item":".canvas-widget.container-widget"),this);if(Ax.length>0){var Ay=Ax.closest(".canvas-widget.container-widget");if(Ay.attr("data-widget-id")==Ax.attr("data-widget-id")){if(A2){Ax.remove()}else{if(A0.sender){A0.sender.sortable("cancel")}else{AY(this).sortable("cancel")}}Au=true;openAlertDialog({title:vBulletin.phrase.get("move_not_allowed"),message:vBulletin.phrase.get("dropping_container_module_into_container_module_not_allowed"),iconType:"warning"});return true}return false}return false};var As=function(Ax){if(Ax.parents(".canvas-widget.container-widget").length>0){if(AY(".module-buttons .admin-only .hide-icon",Ax).length==0){AY(".module-buttons .admin-only",Ax).prepend(At())}}else{Ax.removeClass("hidden-widget").find("> .widget-header .module-buttons .admin-only .hide-icon").remove()}};var Au=false;AQ=AY(".edit-mode .canvas-layout .canvas-widget-list:not(.js-draggable-module-target)");AQ.sortable({revert:true,tolerance:"pointer",connectWith:".edit-mode .canvas-layout:visible .canvas-widget-list",placeholder:"canvas-widget canvas-widget-highlight drag-highlight",create:function(){Q();AD()},update:function(Ay,Az){var A2=this;if(Ae){if(!Au){An(Az.item,function(A6){A6=A6.filter(function(){return this.nodeType===Node.ELEMENT_NODE});Az.item.replaceWith(A6);A6.filter(":not(.container-widget)").find(".toggle-button").trigger("click",[true]);if(!Aw.apply(A2,[Ay,Az])){As(A6);A6.addClass("shadow").find(".widget-tabs").andSelf().filter(".widget-tabs").tabs();O();A6.parents(".canvas-widget.container-widget").find(".canvas-widget.dummy-widget").remove();var A7=A6.parents(".canvas-widget.container-widget");if(A7.length==1){A7.find(".canvas-widget-highlight").remove();A7.find(".module-item").remove()}}var A4=A6.data("widget-id"),A3=v(A6),A5=function(A8){A6.attr("data-widget-instance-id",A8);if(A3){T(A6)}l(A6)};if(A4){m(A3,A4,{},A5)}})}}else{if(!Aw.apply(A2,[Ay,Az])){As(Az.item);O()}if(AY.contains(this,Az.item[0])){var A1=Az.item.closest(".canvas-widget"),Ax=v(A1),A0=A1.data("widget-instance-id")||0;T(A1);if(A0){vBulletin.AJAX({call:"/ajax/api/widget/saveWidgetinstanceContainerinstanceid",data:{widgetinstanceid:A0,containerinstanceid:Ax},success:function(A3){console.log("saveWidgetinstanceContainerinstanceid success: "+JSON.stringify(A3))}})}}}if(Az.sender){var A1=Az.sender.closest(".canvas-widget");if(A1.length){T(A1)}}x=true},out:function(Ax,Ay){AY(this).css("overflow","")},sort:function(Ax,Ay){if(z){Ae=true}var Az=Ay.placeholder.closest(".canvas-widget.container-widget");if(Az.length==1&&Az.find(".canvas-widget:last-child").hasClass("canvas-widget-highlight")){Ay.placeholder.css({"margin-bottom":0,"margin-top":-3})}else{Ay.placeholder.css({"margin-bottom":"","margin-top":""})}},start:function(Ax,Ay){F("hidden",Ay.item)},over:function(Ax,Ay){},stop:function(Ay,Az){AY(this).css("overflow","");Au=false;AD();Ae=false;Az.item.height("auto");F("visible");AY(".canvas-layout .canvas-widget-list .canvas-widget-highlight").remove();var Ax=AY(".canvas-layout > .canvas-layout-row .canvas-widget-list > .canvas-widget.container-widget");AY(".canvas-layout > .canvas-layout-row .canvas-widget-list > .canvas-widget.container-widget").each(function(){var A0=AY(".canvas-widget-list",this);if(A0.children().length==0){A0.append('<div class="canvas-widget dummy-widget"><span>{0}</span></div>'.format(vBulletin.phrase.get("you_can_also_drag_and_drop_modules_here")))}else{if(A0.find(".canvas-widget.dummy-widget").length>0&&A0.find(".canvas-widget:not(.dummy-widget,.canvas-widget-highlight)").length>0){A0.find(".canvas-widget.dummy-widget").remove()}}})},receive:function(Ax,Ay){if(Ay.item.hasClass("module-item")){Aw.apply(this,[Ax,Ay,true])}},handle:".move-icon",items:".canvas-widget:not(.js-widget-non-sortable,.js-widget-pinned-sortable)",}).find(".canvas-widget .widget-header").disableSelection();AY(document).on("click",".edit-mode .canvas-widget .js-pin-module-button",function(){var A2=AY(this),A1=A2.closest(".canvas-widget"),Ax=A1.find("js-move-button"),A0="js-widget-pinned-sortable",Az="pin-icon--pinned",Ay=A1.hasClass(A0);A1.toggleClass(A0,!Ay);A2.toggleClass(Az,!Ay)});AY(document).on("click",".edit-mode .canvas-widget .close-button",function(){var Ax=AY(this);openConfirmDialog({title:vBulletin.phrase.get("remove_module_q"),message:vBulletin.phrase.get("do_you_want_to_remove_module",Ax.closest(".widget-header").find(".module-title").text()),iconType:"warning",onClickYes:function(){var A1=Ax.closest(".canvas-widget"),A0=A1.data("widget-instance-id"),Az=A1.parent(),Ay=A1.parents(".canvas-widget.container-widget");A1.remove();AD();O();x=true;AT([A0]);T(Az);if(Ay.find(".canvas-widget").length==0){Ay.find(".canvas-widget-list").append('<div class="canvas-widget dummy-widget"><span>{0}</span></div>'.format(vBulletin.phrase.get("you_can_also_drag_and_drop_modules_here")))}}})});AY(document).on("click",".edit-mode .js-search-widget .edit-button",function(){F("hidden");Ar(AY(this).closest(".js-search-widget"));AY("#search-config-dialog").dialog("open");return false});function Av(A9,A8){var Ax=AY("#edit-page-dropdown .lnkSaveChanges .label").text();if(!A8){if(!AY.trim(AY("#save-page-form #pagetitle").val())){openAlertDialog({title:Ax,message:vBulletin.phrase.get("please_enter_page_name"),iconType:"warning",onAfterClose:function(){AY("#save-page-form #pagetitle").focus()}});return false}if(AY("body").hasClass("lnkEditPage")){var A7=AY("#save-page-form #pagetemplateid-yes");var Ay=AY("#save-page-form #pagetemplateid-no");if(!A7.prop("checked")&&!Ay.prop("checked")){openAlertDialog({title:Ax,message:vBulletin.phrase.get("please_choose_overwrite_template_options"),iconType:"warning",onAfterClose:function(){AY("#save-page-form #pagetemplateid-yes").focus()}});return false}else{if(Ay.prop("checked")){var Az=AY("#save-page-form #templatetitle-edit");var BC=AY.trim(Az.val());if(!BC||BC==Az.prop("defaultValue")){openAlertDialog({title:Ax,message:vBulletin.phrase.get("please_enter_new_template_name"),iconType:"warning",onAfterClose:function(){AY("#save-page-form #templatetitle-edit").focus()}});return false}openConfirmDialog({title:Ax,message:vBulletin.phrase.get("applying_new_template",AY("#save-page-form #templatetitle-edit").val()),buttonLabel:{yesLabel:vBulletin.phrase.get("save_page"),noLabel:vBulletin.phrase.get("cancel")},iconType:"warning",onClickYes:function(){},onAfterClose:function(){if(AY(this).attr("id")=="btnConfirmDialogYes"){AY("#save-page-form #btnOK").trigger("click",true)}}});return false}else{if(A7.prop("checked")){if(y&&(!x&&!AA)){AY("#save-page-form #btnOK").trigger("click",true)}else{openConfirmDialog({title:Ax,message:vBulletin.phrase.get("overwrite_template_continue"),buttonLabel:{yesLabel:vBulletin.phrase.get("save_page"),noLabel:vBulletin.phrase.get("cancel")},iconType:"warning",onClickYes:function(){},onAfterClose:function(){if(AY(this).attr("id")=="btnConfirmDialogYes"){AY("#save-page-form #btnOK").trigger("click",true)}}})}return false}}}}else{var Az=AY("#save-page-form #templatetitle-new");var BC=AY.trim(Az.val());if(!BC||BC==Az.prop("defaultValue")){openAlertDialog({title:Ax,message:vBulletin.phrase.get("please_enter_new_template_name"),iconType:"warning",onAfterClose:function(){AY("#save-page-form #templatetitle-new").focus()}});return false}}}var BB=AY(".canvas-layout:visible");Ah=BB.attr("id");var A6=parseInt(BB.attr("data-layout-id"),10);AY("#save-page-form #screenlayoutid").val(A6);function A0(BG){var BH={widgetId:BG.attr("data-widget-id"),widgetInstanceId:(BG.attr("data-widget-instance-id")||"0")};if(BG.is(".container-widget")){var BD=[];var BF=[];AY("div.canvas-widget-list > div.canvas-widget",BG).each(function(BI){if(!AY(this).hasClass("hidden-widget")){BF.push(AY(this).attr("data-widget-instance-id"))}BD.push(A0(AY(this)))});BH.subModules=BD;BH.displaySubModules=BF}if(BG.data("is-tabbed-container")){var BE=[];BG.find("> .js-admin-widget-content > .js-admin-widget-tab").each(function(){var BI=AY(this);BI.find("> .widget-content > .canvas-layout-row > .canvas-widget-list > .canvas-widget:not(.dummy-widget)").each(function(){var BJ=AY(this);BE.push(A0(BJ))})});BH.tabbedContainerSubModules=BE}return BH}AY('input[type=hidden][name*="displaysections"]',BB).clone().appendTo(AY("#moduleData").empty());AY("#"+Ah+" > .canvas-layout-row > div.canvas-widget-list").each(function(){var BD=[],BE=L(this);AY(this).children("div.canvas-widget").each(function(){BD.push(A0(AY(this)))});AY('#save-page-form input[name="displaysections['+BE+']"]').val(JSON.stringify(BD))});var A5=AY("#save-page-form"),A4=A5.find("#ishomeroute"),A2={};if(!A4.is(":disabled")){A2.ishomeroute=0}AY.each(A5.serializeArray(),function(BD,BE){A2[BE.name]=BE.value});function BA(BD){vBulletin.AJAX({call:"/admin/savepage",data:{input:BD,url:window.location.href},complete:function(){AY("body").css("cursor","auto")},success:function(BE){if(BE.url!=null){window.location.href=BE.url}},error_phrase:"error_saving_page",})}var A1=AY("input[name='screenlayoutid'][value='"+A6+"']");if(A1.length>0&&A1.attr("data-guid")=="vbulletin-screenlayout-bare-full-57433eecd10803.93763070"){var A3={title:vBulletin.phrase.get("warning"),message:vBulletin.phrase.get("you_cannot_revert_this_layout_confirm"),onClickYes:function(){BA(A2)}};openConfirmDialog(A3)}else{BA(A2)}}AY(document).on("click","#save-page-form #btnOK",Av);AY("#config-dialog").dialog({title:vBulletin.phrase.get("module_configuration"),autoOpen:false,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,height:500,width:800,dialogClass:"dialog-container config-dialog-container input-dialog",open:function(){AY("#config-dialog .loader").show();AY("body").css("cursor","wait")},create:function(){AY(document).on("submit",".sitebuilder-widget-form",function(){function Ay(A0){AY("body").css("cursor","wait");AY("#config-dialog .js-button").prop("disabled",true);var A1=AY("#config-dialog").data("selected-module");var Az=A0.action;vBulletin.AJAX({url:Az,type:A0.method,data:(AY(A0).serializeArray()),success:function(A3){AY("body").css("cursor","auto");if(A3.data){var A2=A3.data.title||A3.data.searchResultTitle||A3.data.searchTitle;if(A2){A1.find(".module-title .admin-only").text(vBulletin.phrase.get("x_module",A2))}switch(A3.data.widget_type){case"custom-html-widget":A1.find(".widget-content").html(A3.data.html);n(A1,true);break;case"video-widget":var A4=A3.data.embed_data;if(A4){var A7=A1.find(".widget-content .videocontainer");if(A7.length==0){A7=AY("<div />").addClass("videocontainer").appendTo(A1.find(".widget-content"))}var A6={code:A4.code,provider:A4.provider,width:"100%",height:260};AY.post(vBulletin.getAjaxBaseurl()+"/ajax/render/bbcode_video",A6,function(A8){if(A8){A7.empty().append(A8);n(A1,true)}},"json");A1.find(".widget-content").find(".note").addClass("h-hide")}break}var A5=AY('select[name="data[default_tab]"]',AY(A0));if(A5.length>0){A1.attr("data-widget-default-tab",A5.val())}AA=true}AY("#config-dialog").dialog("close")},after_error:function(){AY("#config-dialog .loader").hide();AY("#config-dialog .js-button").prop("disabled",false)},error_phrase:["error_saving_configuration_module",AY("#config-dialog .widget-name h1").text()],})}var Ax=this;Ay(Ax);return false});AY("#btnCloseConfig").on("click",function(){AY("#config-dialog").dialog("close")})},close:function(){F("visible");AY("#config-dialog .js-button").prop("disabled",false)}});AY("#pagetitle").on("keyup blur",function(Ax){if(y){AY("#pageurl").val(this.value.replace(/[^\w-]+/g,""))}return true});AY("#save-page-form #pagetemplateid-yes").on("click",function(){AY("#save-page-form .template-name").addClass("h-hide");AY("#save-page-form #templatetitle").prop("disabled",false);AY("#save-page-form #templatetitle-edit").prop("disabled",true);AY("#save-page-form .page-template-name").removeClass("h-hide")});AY("#save-page-form #pagetemplateid-no").on("click",function(){AY("#save-page-form .template-name").removeClass("h-hide");AY("#save-page-form #templatetitle").prop("disabled",true);AY("#save-page-form #templatetitle-edit").prop("disabled",false);AY("#save-page-form .page-template-name").addClass("h-hide")});function Ar(Ax){if(typeof k.search_config_dialog=="undefined"){vBulletin.AJAX({call:"/ajax/render/dialog_search_config",success:function(Ay){k.search_config_dialog=Ay;AY("body").append(Ay);Ar(Ax)},error_phrase:"error_fetching_dialog"});return }if(Ax){AY("#search-config-dialog").data("search-widget",Ax)}AY("#search-config-dialog").dialog({title:vBulletin.phrase.get("edit_search_module"),autoOpen:true,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:800,dialogClass:"dialog-container search-config-dialog-container input-dialog",close:function(){F("visible")},open:function(){var Ay=this;AY("#customSearchDialog",Ay).addClass("h-invisible");AY("body").css("cursor","wait");setTimeout(function(){vBulletin.search=vBulletin.search||{};var A1=function(){U=new vBulletin.search.SearchControl("#customSearchDialog");V(U)};var A0=AY("#search-config-dialog").data("search-widget");var A3={id:A0.attr("data-widget-id"),instanceid:A0.attr("data-widget-instance-id")};if(typeof vBulletin.search.SearchControl=="undefined"){var A2=["/js/jquery/jquery.qtip.min.js","/js/tag-editor.js","/js/sb_search.js"];var Az=function(){if(A2.length==0){AY("body").css("cursor","auto");AY("#customSearchDialog",Ay).removeClass("h-invisible");A1();return }var A4=A2.shift();AY.getScript(vBulletin.getAjaxBaseurl()+A4+"?"+pageData.simpleversion,Az).error(function(A8,A7,A5){var A6=(A5&&A5.message)?"{0}: {1}".format(vBulletin.phrase.get("error"),A5.message):"HTTP {0}: {1}".format(A8.status,A8.statusText);AY("#search-config-dialog").dialog("close");openAlertDialog({title:vBulletin.phrase.get("error"),message:"{0}<br /><br />({1})".format(vBulletin.phrase.get("error_loading_search_config_script"),A6),iconType:"error"})}).complete(function(){})};Az()}else{AY("#customSearchDialog",Ay).removeClass("h-invisible");A1()}},1);AA=false},create:function(){AY("#btnSaveSearchConfig").on("click",function(){AY("body").css("cursor","wait");var A0=AY("#search-config-dialog").data("search-widget");var A9={id:A0.attr("data-widget-id"),instanceid:A0.attr("data-widget-instance-id")};var A4={pageid:pageData.pageid,widgetid:A9.id,widgetinstanceid:A9.instanceid,pagetemplateid:AY("#select-template input[type=radio]:checked").val(),searchJSON:{}};var BE=AY("#searchTitle");if(BE.length>0&&AY.trim(BE.val()).length>0){A4.searchTitle=AY.trim(BE.val());BE.data("defaultValue",A4.searchTitle)}var A6=AY("#resultsPerPage");if(A6.length>0&&AY.trim(A6.val()).length>0){A4.resultsPerPage=AY.trim(A6.val());A6.data("defaultValue",A4.resultsPerPage)}var A2=["hide_avatars","hide_module_when_empty","hide_usernames","displayFooter"];for(var A5=0;A5<A2.length;A5++){var Ay=A2[A5],A3=AY("input[name='"+Ay+"'][value='1']");if(A3.length>0&&A3.prop("checked")){A4[Ay]="1";A3.data("defaultValue","1")}else{A4[Ay]="0";A3.data("defaultValue","0")}}var A8=AY(".js-searchmodule-show-at-breakpoints");if(A8.length>0){A4.show_at_breakpoints={desktop:1,small:1,xsmall:1};A8.find("input").each(function(){var BF=AY(this);switch(BF.prop("name")){case"show_at_breakpoints[desktop]":A4.show_at_breakpoints.desktop=BF.prop("checked")?1:0;break;case"show_at_breakpoints[small]":A4.show_at_breakpoints.small=BF.prop("checked")?1:0;break;case"show_at_breakpoints[xsmall]":A4.show_at_breakpoints.xsmall=BF.prop("checked")?1:0;break}});A8.data("defaultValue",A4.show_at_breakpoints)}var BC=AY("#search-config-dialog .js-sb-module-config--viewpermissions");if(BC.length>0){A4.module_viewpermissions={};var A7=BC.find("input.js-module_viewpermissions__key:checked"),BB="show_all",Az=BC.find("input.js-module_viewpermissions__value:checked"),BA="all";if(A7.length){BB=A7.prop("value")}if(Az.length){BA=[];AY.each(Az,function(BF,BG){BA.push(AY(BG).prop("value"))})}A4.module_viewpermissions={key:BB,value:BA,}}var A1=AY("#search-config-dialog .js-sb-module-config--filter_nodes"),BD;if(A1.length>0){BD=t(A1.find(":input"));if("data" in BD&&"module_filter_nodes" in BD.data){A4.module_filter_nodes=BD.data.module_filter_nodes}else{A4.module_filter_nodes={}}}A4.searchJSON=U.load();vBulletin.AJAX({call:"/ajax/api/widget/saveSearchWidgetConfig",data:{data:JSON.stringify(A4)},complete:function(){AY("body").css("cursor","auto")},success:function(BF){if(BF.widgetinstanceid>0&&BF.searchJSON){A0.attr("data-widget-instance-id",BF.widgetinstanceid);A0.find(".main-title").text(A4.searchTitle);AY("#config_widgetinstanceid").val(BF.widgetinstanceid);AY("#config_pagetemplateid").val(BF.pagetemplateid);AY("#pagetemplateid-new").val(BF.pagetemplateid);AY("#search-config-dialog").dialog("close");n(A0,true);AA=true}},error_phrase:"error_saving_search_config",})});AY("#btnCancelSearchConfig").on("click",function(){function Ay(){AY("#search-config-dialog").dialog("close");U.set("{}");var A8=AY("#search-config-dialog #searchTitle");A8.val(A8.data("defaultValue"));var A4=AY("#search-config-dialog #resultsPerPage");A4.val(A4.data("defaultValue"));var A1=["hide_avatars","hide_module_when_empty","hide_usernames","displayFooter"];for(var A3=0;A3<A1.length;A3++){var A0=A1[A3],A2=AY("#search-config-dialog input[name='"+A0+"'][value='1']"),A5=AY("#search-config-dialog input[name='"+A0+"'][value='0']");if(A2.data("defaultValue")=="1"){A2.prop("checked",true)}else{A5.prop("checked",true)}}var A6=AY("#search-config-dialog .js-searchmodule-show-at-breakpoints");if(A6.length>0){var A7=A6.data("defaultValue");if(typeof (A7)!="undefined"){A6.find("input").each(function(){var A9=AY(this);switch(A9.prop("name")){case"show_at_breakpoints[desktop]":A9.prop("checked",A7.desktop?"checked":"");break;case"show_at_breakpoints[small]":A9.prop("checked",A7.small?"checked":"");break;case"show_at_breakpoints[xsmall]":A9.prop("checked",A7.xsmall?"checked":"");break}})}}}if(AA){var Az=AY(this);openConfirmDialog({title:vBulletin.phrase.get("cancel_edit"),message:vBulletin.phrase.get("do_you_want_to_cancel_editing_search_module"),iconType:"warning",onClickYes:Ay})}else{Ay()}})}})}AY("#blog-category-dialog").dialog({title:vBulletin.phrase.get("edit_blog_categories"),autoOpen:false,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:800,dialogClass:"dialog-container blog-category-dialog-container input-dialog",close:function(){F("visible")},open:function(){var Ax=this;AA=false},create:function(){AY("#blog-category-dialog #btnSaveCategories").on("click",function(){AY("body").css("cursor","wait");AY("#blog-category-dialog dialog-content loader").show();var Ax=AY("#search-config-dialog").data("blog-category-widget");var Ay={id:Ax.attr("data-widget-id"),instanceid:Ax.attr("data-widget-instance-id")};vBulletin.AJAX({call:"/ajax/api/widget/saveBlogCategories",data:{},complete:function(){AY("body").css("cursor","auto");AY("#blog-category-dialog dialog-content loader").hide()},success:function(Az){AY("#blog-category-dialog dialog-content widget-config-container").html(Az)},error_phrase:"error_saving_blog_categories"})});AY("#blog-category-dialog #btnNewCategory").on("click",function(){});AY("#blog-category-dialog #btnCloseCategories").on("click",function(){if(AA){var Ax=AY(this);openConfirmDialog({title:vBulletin.phrase.get("cancel_edit"),message:vBulletin.phrase.get("do_you_want_to_cancel_editing_blog_categories_module"),iconType:"warning",onClickYes:AY("#blog-category-dialog").dialog("close")})}else{AY("#blog-category-dialog").dialog("close")}})}})}function t(Ar){if(Ar.length<1){return{}}var Aq={};Ar.serializeArray().forEach(function(As){var At=Ac(As.name,As.value);Aq=B(Aq,At)});return Aq}function B(As,Ar){if(Array.isArray(Ar)){Ar.forEach(function(At){As.push(At)})}else{if(typeof Ar!="object"){return Ar}for(var Aq in Ar){if(!Ar.hasOwnProperty(Aq)){continue}if(Aq in As){As[Aq]=B(As[Aq],Ar[Aq])}else{As[Aq]=Ar[Aq]}}}return As}function Ac(Aq,As){var Ar=K(Aq);return Ak(Ar,As)}function Ak(Ar,As){var Aq=Ar.shift(),At={};if(Ar.length>0){As=Ak(Ar,As)}if(Aq==""){return[As]}else{At[Aq]=As}return At}function K(Ar){var Aq=Ar.indexOf("["),Ax=(Aq>=0)&&Ar.substring(0,Aq)||Ar,As=(Aq>=0)&&Ar.substring(Aq)||"",Av=/\[([^\]]*)\]/g,Aw,Au=5,At=[Ax];if(As.length>0){do{Aw=Av.exec(As);if(Aw&&"1" in Aw){At.push(Aw[1])}}while(Aw!==null&&Au-->0)}return At}function V(Aq){var As=AY(this).closest(".canvas-widget"),Ar=AY("#search-config-dialog").data("search-widget"),At={id:Ar.attr("data-widget-id"),instanceid:Ar.attr("data-widget-instance-id")};vBulletin.AJAX({call:"/ajax/api/widget/fetchSearchConfig",data:({widgetid:At.id,widgetinstanceid:At.instanceid||"",pagetemplateid:Y(),configtype:"admin"}),complete:function(){AY("body").css("cursor","auto")},success:function(Au){if(Au.searchTitle){AY("#searchTitle").val(Au.searchTitle)}if(Au.resultsPerPage){AY("#resultsPerPage").val(Au.resultsPerPage)}var Az=["hide_avatars","hide_module_when_empty","hide_usernames","displayFooter"];for(var Ay=0;Ay<Az.length;Ay++){var Aw=Az[Ay];value=((Au[Aw]&&parseInt(Au[Aw],10)==1)?1:0);AY("input[name='"+Aw+"'][value='"+value+"']").prop("checked",true)}if(Au.show_at_breakpoints){var A1=AY("#search-config-dialog .js-searchmodule-show-at-breakpoints");if(A1.length>0){A1.find("input").each(function(){var A2=AY(this);switch(A2.prop("name")){case"show_at_breakpoints[desktop]":A2.prop("checked",Au.show_at_breakpoints.desktop?"checked":"");break;case"show_at_breakpoints[small]":A2.prop("checked",Au.show_at_breakpoints.small?"checked":"");break;case"show_at_breakpoints[xsmall]":A2.prop("checked",Au.show_at_breakpoints.xsmall?"checked":"");break}})}}if(Au.module_viewpermissions){var Av=AY("#search-config-dialog .js-searchmodule-module_viewpermissions--replaceme"),Ax=D({defaultvalue:Au.module_viewpermissions});Av.replaceWith(Ax)}if(Au.searchJSON){if(typeof Au.searchJSON=="string"){Au.searchJSON=JSON.parse(Au.searchJSON||"{}")}if(Au.searchJSON.channel&&Au.searchJSON.channel.length>0){if("param" in Au.searchJSON.channel){Au.module_filter_nodes={include:["current"]};Au.module_filter_nodes.include_children=true}else{Au.module_filter_nodes={include:[]};Au.module_filter_nodes.include_children=true;if(typeof Au.searchJSON.channel=="number"||typeof Au.searchJSON.channel=="string"){Au.searchJSON.channel=[Au.searchJSON.channel]}if(Au.searchJSON.channel&&Au.searchJSON.channel.length>0){Au.searchJSON.channel.forEach(function(A2){Au.module_filter_nodes.include.push(A2)})}}}}if(Au.module_filter_nodes){var A0=AY("#search-config-dialog .js-searchmodule-module_filter_nodes--replaceme"),Ax=Z({defaultvalue:Au.module_filter_nodes});A0.replaceWith(Ax);AY("#search-config-dialog select.js-module_filter_nodes-values").selectBox()}Aq.set(Au.searchJSON||{},Au.contentTypes||{},Au.channels||{});AY("#config-dialog .dialog-content .widget-config-container").show();AY("#search-config-dialog .form_layout .form_row .field_column select").selectBox();AY("#config-dialog .loader").hide()},after_error:function(){AY("#config-dialog .loader").hide();AY("#config-dialog").dialog("close")}})}AY(document).ready(function(){AO()})})(jQuery);