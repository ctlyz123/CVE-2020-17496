// ***************************
// js.compressed/sb_socialgroups.js
// ***************************
/*=======================================================================*\
|| ###################################################################### ||
|| # vBulletin 5.6.0
|| # ------------------------------------------------------------------ # ||
|| # Copyright 2000-2020 MH Sub I, LLC dba vBulletin. All Rights Reserved.  # ||
|| # This file may not be redistributed in whole or significant part.   # ||
|| # ----------------- VBULLETIN IS NOT FREE SOFTWARE ----------------- # ||
|| # http://www.vbulletin.com | http://www.vbulletin.com/license.html   # ||
|| ###################################################################### ||
\*========================================================================*/
window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["contenttype_vbforum_socialgroup","error","invalid_page_specified","searchtype_social_groups"]);(function(E){var O=[".socialgroup-home-widget",".socialgroup-category-list-widget"];if(!vBulletin.pageHasSelectors(O)){return false}vBulletin.conversation=vBulletin.conversation||{};var U,P={},N,K,B,X;function I(Z){var e=E(".activity-stream-widget"),d=e.offset().top,c=e.outerHeight(),a=parseFloat(e.css("border-bottom-width")),Y=Z.height(),b=(d+c-a-Y);return b}function C(){return E(".activity-stream-widget .js-module-top-anchor").attr("id")}function T(){var d=E(".activity-stream-widget");function a(h){var g=E(this),f=g.closest("form.poll"),i=f.find("ul.poll");g.addClass("h-hide");i.css("max-height","none").find("li.h-hide").slideDown(100,function(){f.find(".js-button-group").removeClass("h-hide").next(".view-less-ctrl").removeClass("h-hide");vBulletin.animateScrollTop(f.offset().top,{duration:"fast"})});return false}function Z(g){var f=E(this).closest("form.poll");vBulletin.conversation.limitVisiblePollOptionsInAPost(f,3);f.find("ul.poll").css("max-height","").find("li.h-hide").slideUp(100);return false}function b(f){vBulletin.conversation.editPost.apply(this,[f,N])}function Y(f){if(E(f.target).closest(".js-bubble-flyout").length==1){vBulletin.conversation.showWhoVoted.apply(f.target,[f])}else{vBulletin.conversation.votePost.apply(this,[f])}return false}function c(f){vBulletin.conversation.postComment.apply(this,[f,function(){N.updatePageNumber(1).applyFilters(false,true)}])}d.off("click",".list-item-poll .view-more-ctrl").on("click",".list-item-poll .view-more-ctrl",a);d.off("click",".list-item-poll .view-less-ctrl").on("click",".list-item-poll .view-less-ctrl",Z);d.off("click",".js-post-control__ip-address").on("click",".js-post-control__ip-address",vBulletin.conversation.showIp);d.off("click",".js-post-control__edit").on("click",".js-post-control__edit",b);d.off("click",".js-post-control__vote").on("click",".js-post-control__vote",Y);d.off("click",".js-post-control__flag").on("click",".js-post-control__flag",vBulletin.conversation.flagPost);d.off("click",".js-post-control__comment").on("click",".js-post-control__comment",vBulletin.conversation.toggleCommentBox);d.off("click",".js-comment-entry__post").on("click",".js-comment-entry__post",c)}function V(Z,Y){if(!K){K=vBulletin.conversation.filter({context:Y,autoCheck:false,scrollToTop:Z,pagination:false,allowHistory:false,tabParamAsQueryString:true,beforeApplyFilters:function(){D({},false);return false},})}}function L(){var m=E(".socialgroup-widget");if(!m.hasClass("socialgroup-home-widget")){return }var d=E(".activity-stream-widget"),Y=E("#activity-stream-tab",d),j,b,h,a=d.find(".widget-tabs-nav .ui-tabs-nav > li"),f=a.filter(".ui-tabs-active"),e=f.index(),l=false,c=a.parent().data("allow-history")=="1",Z=new vBulletin.history.instance(c);function o(q){q=q||X;return a.filter('li:has(a[href*="'+q+'"])').first().index()}function i(x,u,w,v,z,q){var s=E(".conversation-toolbar-wrapper.scrolltofixed-floating",x),t=new vBulletin.scrollToFixed({element:s,limit:I(s)}),r=null,y;if(v){y=new vBulletin.pagination({context:x,allowHistory:w,onPageChanged:function(AA,AB){r.updatePageNumber(AA);if(!AB){r.applyFilters(false,true,false,true)}}})}r=new vBulletin.conversation.filter({context:x,autoCheck:z?E(".toolbar-filter-overlay input[type=radio][value=conversations_on]",x).is(":checked"):undefined,scrollToTop:u,pagination:y,allowHistory:w,onContentLoad:q});return{"$bar":s,"$floating":t,pagination:y,filter:r}}function g(q){vBulletin.truncatePostContent(q);vBulletin.conversation.processPostContent(q)}function n(t,s,q){var r=s.filter;if(s.pagination){s.pagination.setOption("context",t)}r.setOption("context",t);if(typeof r.lastFilters!="undefined"&&E(".conversation-empty:not(.h-hide)",q).length>0){delete r.lastFilters}}function p(w,t,v,u,y,r,s,z){var x=i(w,t,v,u,y,function(){x.$floating.updateLimit(I(x.$bar));if(s){g(s)}if(z){z()}});var q=x.filter;if(r){if(s){g(s)}q.lastFilters={filters:q.getSelectedFilters(E(".toolbar-filter-overlay",w))}}return x}function k(u,s,w){var t=s.id,v=(X==w);if(typeof P[t]=="undefined"){P[t]=E(".conversation-toolbar-wrapper",s).data("allow-history")=="1"}if(w=="#activity-stream-tab"){if(!N){var q=E(".conversation-list",Y);j=p(Y,d,P[t],false,true,v,q,null);N=j.filter;if(v){E(this).data("noPushState",true)}}else{n(Y,j,s)}N.applyFilters(false,true)}else{if(w=="#groups-tab"){V(d,E("#groups-tab"));if(N){N.toggleNewConversations(false)}if(!U){U=vBulletin.history.instance(P[t]);if(v){F(true)}Q()}var r=E(".conversation-empty",s);if(r.length>0){if(v&&!b){b=true;return false}r.addClass("h-hide");D({},!E(this).data("noPushState"))}}}}if(e==-1){e=0;f=a.first()}X=f.find("> a").attr("href");a.removeClass("ui-state-disabled");vBulletin.tabify.call(d,{tabHistory:Z,getTabIndexByHash:o,allowHistory:c,tabParamAsQueryString:true,hash:C(),tabOptions:{active:e,beforeActivate:function(s,t){if(N){N.hideFilterOverlay()}var r=d.find(".widget-tabs-panel .ui-tabs-panel:visible"),q=r.find(".list-item-body-wrapper.edit-post .edit-conversation-container");if(q.length>0){openAlertDialog({title:vBulletin.phrase.get("edit_conversation"),message:vBulletin.phrase.get("you_have_a_pending_edit_unsaved"),iconType:"warning",onAfterClose:function(){vBulletin.animateScrollTop(q.closest(".list-item").offset().top,{duration:"slow"})}});return false}},create:function(q,r){k(r.tab,r.panel,r.panel.selector)},activate:function(q,r){k(r.newTab,r.newPanel,r.newPanel.selector)}}});T();vBulletin.conversation.bindEditFormEventHandlers("all")}function F(b){if(U.isEnabled()){var c=U.getState();if(!c||E.isEmptyObject(c.data)){var Z={from:"filter_groups",page:Number(E(".pagenav-form .defaultpage",B).val())||1,filters:{filter_groups:E(".js-button-filter.js-checked",B).data("filter-value")}};if(b){Z.tab="#groups-tab"}var Y=vBulletin.parseQueryString(location.search),a;if(b&&typeof Y.tab=="undefined"&&X&&X!="#groups-tab"){Y.tab="groups-tab";a=location.pathname+"?"+E.param(Y)}else{a=location.href}U.setDefaultState(Z,document.title,a)}}}function Q(){if(U.isEnabled()){U.setStateChange(function(c,h,f){var Y=U.getState();if(Y.data.from=="filter_groups"||h=="pagination"){U.log(Y.data,Y.title,Y.url);var g=E(".socialgroup-widget"),d=g.hasClass("ui-tabs")&&g,a=d&&d.tabs("option","selected"),i=d&&d.find(".ui-tabs-nav > li").eq(a).find("a").attr("href");if(i!==false&&i!=Y.data.tab){var b=d.find(".ui-tabs-nav > li").filter('li:has(a[href*="{0}"])'.format(Y.data.tab)).index();vBulletin.selectTabByIndex.call(d,b)}else{var Z={page:Y.data.page,my:h=="pagination"&&f?(f.filter_groups||"show_all"):Y.data.filters.filter_groups,display_groups:h=="pagination"&&f?(f.display_groups||"display_grid"):Y.data.filters.display_groups};D(Z,false)}}},"filter")}}function R(Y){vBulletin.AJAX({call:"/ajax/api/content_channel/canAddChannel",data:{nodeid:pageData.channelid},success:function(Z){if(Z.can===true){location.href=pageData.baseurl+"/sgadmin/create/settings"}else{if(Z.exceeded>0){vBulletin.warning("social_groups","you_can_only_create_x_groups_delete")}}},title_phrase:"social_groups"})}function W(Z){var Y=E(this),a={page:1};if(Y.is(".js-button-filter-my")){a.my=Y.data("filter-value");a.display_groups=E(".js-button-filter-display-groups.js-checked",B).data("filter-value")}else{a.my=E(".js-button-filter-my.js-checked",B).data("filter-value");a.display_groups=Y.data("filter-value")}D(a,true)}function M(){function Y(Z){var a=Z.data("js-movable-button-clone-id");return E(".js-movable-toolbar-button-clone").filter(function(){return E(this).data("js-movable-button-clone-id")==a})}B.find(".js-button-filters .js-button-filter").removeClass("b-button--pressed").each(function(){Y(E(this)).removeClass("b-button--pressed")}).filter(".js-checked").addClass("b-button--pressed").each(function(){Y(E(this)).addClass("b-button--pressed")})}function D(f,b){var c=E(".conversation-list",B),e=E(".sg-groups-list",c),Z=E(".sg-groups-pagination",e);f.sgparent=f.sgparent||E(".js-category",Z).val();f.page=f.page||E(".js-pagenum",Z).val();f.perpage=f.perpage||E(".js-perpage",Z).val();f.my=f.my||B.find(".js-button-filters .js-button-filter-my.js-checked").data("filter-value");f.display_groups=f.display_groups||B.find(".js-button-filters .js-button-filter-display-groups.js-checked").data("filter-value");f.routeInfo=f.routeInfo||e.find(".sg-groups-list-container").data("route");f.sort_field=f.sort_field||B.find('.toolbar-filter-overlay input[name="filter_sort"]:checked').val()||"title";f.sort_order=f.sort_order||B.find('.toolbar-filter-overlay input[name="filter_order"]:checked').val()||"asc";E(".js-button-filters .js-button-filter-my",B).removeClass("js-checked").filter('[data-filter-value="{0}"]'.format(f.my)).addClass("js-checked");E(".js-button-filters .js-button-filter-display-groups",B).removeClass("js-checked").filter('[data-filter-value="{0}"]'.format(f.display_groups)).addClass("js-checked");f.isAjaxTemplateRenderWithData=true;vBulletin.AJAX({call:"/ajax/render/socialgroup_nodes",data:f,success:function(i){c.replaceWith(i.template);var m=E(".conversation-toolbar-wrapper .pagenav-controls .pagenav-form",B),k=E(".arrow",m).removeClass("h-disabled"),g=B.find(".sg-groups-list .sg-groups-pagination"),j=g.find(".js-prevpage").val(),l=g.find(".js-nextpage").val();E(".js-pagenum",m).val(g.find(".js-pagenum").val());E(".pagetotal",m).text(g.find(".js-totalpages").val());function h(p,o){var n=k.filter(p).toggleClass("h-disabled",!o);if(o){n.attr("href",o)}else{n.removeAttr("href")}}h("[rel=prev]",j);h("[rel=next]",l);M();vBulletin.initFlexGridFixLastRowAll(true);vBulletin.initFrameImagesWithColor()},title_phrase:"contenttype_vbforum_socialgroup",error_phrase:"unable_to_contact_server_please_try_again",});if(b){var a=location.pathname;if(X&&X!="#groups-tab"){a+="?tab=groups-tab"}a=vBulletin.makePaginatedUrl(a,f.page);a=vBulletin.makeFilterUrl(a,"filter_groups",f.my,B);a=vBulletin.makeFilterUrl(a,"display_groups",f.display_groups,B);if(U&&U.isEnabled()){var d=U.getState(),Y={from:"filter_groups",page:f.page,tab:B.hasClass("ui-tabs-panel")?"#"+B.attr("id"):undefined,filters:{filter_groups:f.my,display_groups:f.display_groups}};U.pushState(Y,document.title,a)}else{if(P["groups-tab"]){a=vBulletin.makeFilterUrl(a,"filter_groups",filterValue,B,C());location.href=a;return false}}}}function H(Y,e){if(!Y.length){return }function Z(j){var h=j.innerWidth(),i=parseInt(j.css("paddingLeft"),10),k=parseInt(j.css("paddingRight"),10);return Math.floor(h-i-k)}function c(h){return Math.ceil(h.outerWidth(true))}function g(k,l){var o=!!l;k.width(l);k.toggleClass("b-groupgrid__item-inner--expanded",o);var n=E(".js-groupgrid-item-icon",i).outerWidth();var j=E(".js-groupgrid-item-icon-link",i).outerWidth();if(o&&j>n){k.removeClass("b-groupgrid__item-inner--expanded")}var i=k.first(),m=Z(i),h=m-1;k.find(".js-groupgrid-item-icon-link").width(h).height(h)}g(Y,"");if(!e){return }var d=Y.first(),f=Z(d.closest(".b-groupgrid__item")),b=c(d)-Z(d),a;if(d.closest(".b-groupgrid__item").is(".b-flexgrid__item--lastrow")){return }Y.each(function(){var h=E(this).closest(".b-groupgrid__item");if(h.is(".b-flexgrid__item--lastrow")){return true}f=Math.min(f,Z(h))});a=f-b-1;g(Y,a)}function J(a,Z){var Y=E(".b-groupgrid__item-inner");if(Z&&Z.isResize){Y.css({opacity:"0"})}H(Y,false)}function G(a,Z){var Y=E(".b-groupgrid__item-inner");H(Y,true);if(Z&&Z.isResize){Y.removeClass("h-tranparent").animate({opacity:"1"},400)}}function A(){B=E(".groups-tab",Y);L();var Z=E(".socialgroup-category-list-widget");if(Z.length){V(Z,Z)}P["groups-tab"]=P["groups-tab"]||E(".conversation-toolbar-wrapper",B).data("allow-history")=="1";E(document).off("click",".add-sg").on("click",".add-sg",R);B.off("click",".js-button-filter").on("click",".js-button-filter",W);groupsPagination=new vBulletin.pagination({context:B,allowHistory:P["groups-tab"],onPageChanged:function(e,d,b,c){if(!d){var a=typeof c!="undefined"?vBulletin.parseQueryString(a):null,f={my:a&&typeof a.filter_groups=="undefined"?"show_all":E(".js-button-filter-my.js-checked",B).data("filter-value"),display_groups:a&&typeof a.display_groups=="undefined"?"display_grid":E(".js-button-filter-display-groups.js-checked",B).data("filter-value"),page:e};D(f,d)}}});var Y=E(".socialgroup-widget");if(!Y.hasClass("ui-tabs")){U=vBulletin.history.instance(P["groups-tab"]);F(false);Q()}M();E(document).on("vbulletin:flexgridstart",".js-flexgrid",J);E(document).on("vbulletin:flexgridready",".js-flexgrid",G)}function S(){E(document).ready(function(){A()})}S()})(jQuery);;

// ***************************
// js.compressed/subscribe.js
// ***************************
/*=======================================================================*\
|| ###################################################################### ||
|| # vBulletin 5.6.0
|| # ------------------------------------------------------------------ # ||
|| # Copyright 2000-2020 MH Sub I, LLC dba vBulletin. All Rights Reserved.  # ||
|| # This file may not be redistributed in whole or significant part.   # ||
|| # ----------------- VBULLETIN IS NOT FREE SOFTWARE ----------------- # ||
|| # http://www.vbulletin.com | http://www.vbulletin.com/license.html   # ||
|| ###################################################################### ||
\*========================================================================*/
window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["follow","following","following_pending","social_group_count_members_x","unsubscribe_overlay_error"]);window.vBulletin.options=window.vBulletin.options||{};window.vBulletin.options.precache=window.vBulletin.options.precache||[];window.vBulletin.options.precache=$.merge(window.vBulletin.options.precache,[]);(function(){vBulletin.subscribe={};var C=function(J){var M=$(J);if(M.hasClass("isSubscribed")||M.hasClass("is-pending")){return true}var O=parseInt(M.attr("data-node-id"),10),N={},K="";if(M.hasClass("is-topic")){K="/ajax/api/follow/add";N.follow_item=O;N.type="follow_contents";D(M,K,N)}else{var L={};L.channelid=O;L.recipient=parseInt(M.attr("data-owner-id"),10);if(M.hasClass("is-blog-channel")){L.requestType="member"}else{if(M.hasClass("is-sg-channel")){L.requestType="sg_subscriber"}else{L.requestType="subscriber"}}D(M,"/ajax/api/node/requestChannel",L)}};var H=function(J,K){J.children(".js-button__text-primary").text(vBulletin.phrase.get(K))};var F=function(L,M,K,J){H(L,M);L.addClass((K||"")+" b-button--special").removeClass((J||"")+" b-button--secondary")};var E=function(L,M,K,J){H(L,M);L.addClass((K||"")+" b-button--secondary").removeClass((J||"")+" b-button--special")};var D=function(K,J,L){vBulletin.AJAX({call:J,data:L,success:function(M){if(!isNaN(M)&&M>=1){if(M==1){F(K,"following","isSubscribed")}else{F(K,"following_pending","is-pending")}}else{vBulletin.error("follow","follow_error")}},title_phrase:"follow",error_phrase:"follow_error"})};function B(K,J){var L=$(".js-replace-member-count-"+K);if(L.length){L.each(function(){var P=$(this),O=P.data("replace-phrase-varname"),N=parseInt(P.data("member-count"),10),M=N+J;P.text(vBulletin.phrase.get(O,M));P.data("member-count",M)})}}var A=function(J){var L=$(J),M=parseInt(L.attr("data-node-id"),10),K=parseInt(L.attr("data-owner-id"),10);vBulletin.AJAX({call:"/ajax/api/node/requestChannel",data:({channelid:M,recipient:K,requestType:"sg_member"}),success:function(N){if(N===true){F(L,"joined","has-joined");B(M,1);if(L.hasClass("join-to-post-btn")||L.hasClass("js-refresh")){window.location.reload()}}else{if(!isNaN(N)){F(L,"following_pending","is-pending")}}},title_phrase:"join",error_phrase:"join_error"})};var I=function(J){var K=$(J),L=parseInt($(J).attr("data-node-id"),10);vBulletin.AJAX({call:"/ajax/api/blog/leaveChannel",data:{channelId:L},success:function(M){if(M===true){if(K.hasClass("js-button--follow")){H(K,"follow");K.addClass("b-button--special").removeClass("isSubscribed b-button--unfollow")}else{H(K,"join");K.removeClass("has-joined b-button--special leave-btn")}B(L,-1);if(!K.is(".js-no-refresh")){location.reload()}}else{vBulletin.error("leave","invalid_server_response_please_try_again")}},title_phrase:"leave",error_phrase:"invalid_server_response_please_try_again"})};var G=function(J){var K=$(J),L=$(J).attr("data-node-id");vBulletin.AJAX({call:"/ajax/api/follow/delete",data:{follow_item:L,type:"follow_contents"},success:function(M){if(M==1){E(K,"follow","","isSubscribed b-button--unfollow")}else{vBulletin.error("follow","unfollow_error")}},title_phrase:"follow",error_phrase:"unfollow_error"})};vBulletin.subscribe.updateSubscribeButton=function(K){if(typeof K!="undefined"){var J=$(".js-button--follow").filter(function(){return $(this).data("node-id")==pageData.nodeid&&pageData.nodeid!=pageData.channelid});switch(K){case 0:E(J,"follow","","isSubscribed b-button--unfollow");break;case 1:E(J,"following","isSubscribed");break;case 2:E(J,"following_pending","is-pending");break}}};$(".js-button--follow").on("click",function(J){if(!$(this).hasClass("isSubscribed")){C(this)}else{if($(this).hasClass("b-button--unfollow")){if($(this).hasClass("is-blog-channel")){I(this)}else{G(this)}}}});$(".js-button--follow").on("mouseover",function(J){var K=$(this);if(K.hasClass("isSubscribed")&&!K.hasClass("is-owner")){E(K,"following_remove","b-button--unfollow")}});$(".js-button--follow").on("mouseout",function(J){var K=$(this);if(K.hasClass("b-button--unfollow")){F(K,"following","","b-button--unfollow")}});$(".join-to-post-btn").on("click",function(J){if(!$(this).hasClass("has-joined")&&!$(this).hasClass("is-pending")){A(this)}});$(document).on("click",".join-btn",function(J){if(!$(this).hasClass("has-joined")&&!$(this).hasClass("is-pending")){A(this)}else{if($(this).hasClass("leave-btn")&&!$(this).hasClass("is-owner")){I(this)}}});$(document).on("mouseover",".join-btn",function(J){var K=$(this);if(K.hasClass("has-joined")&&!K.hasClass("is-owner")){E(K,"leave","leave-btn")}});$(document).on("mouseout",".join-btn",function(J){var K=$(this);if(K.hasClass("leave-btn")&&!K.hasClass("is-owner")){F(K,"joined","","leave-btn")}})})();;

