/*=======================================================================*\
|| ###################################################################### ||
|| # vBulletin 5.6.0
|| # ------------------------------------------------------------------ # ||
|| # Copyright 2000-2020 MH Sub I, LLC dba vBulletin. All Rights Reserved.  # ||
|| # This file may not be redistributed in whole or significant part.   # ||
|| # ----------------- VBULLETIN IS NOT FREE SOFTWARE ----------------- # ||
|| # http://www.vbulletin.com | http://www.vbulletin.com/license.html   # ||
|| ###################################################################### ||
\*========================================================================*/
window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["add_moderator_gforumdisplay","confirm_delete_group_channel","delete_a_group_channel","delete_group","edit_group_icon","error_adding_moderator","error_deleting_group","group_icon","group_title_exists","groups","kilobytes","loading_ellipsis","manage_subscribers","transfer_group_ownership","unexpected_error"]);(function(F){var L=[".blogadmin-widget",".summary-widget"];if(!vBulletin.pageHasSelectors(L)){return false}function M(S){if(F(".groupIcon .groupIconUrl").val()){F(".groupIcon .groupIconImg").attr("src",F(".groupIcon .groupIconUrl").val());F(".groupIcon .groupFileDataId").val(F(".groupIcon .initFiledataid").val())}else{F(".groupIcon .groupIconImg").addClass("h-hide");F(".groupIcon .groupFileDataId").val("")}return true}function K(V,T){V.stopPropagation();$moderatorForm=F(this).closest("form");var S=$moderatorForm.find(':input[name="nodeid"]').val(),U=T.getElements()[0]["value"];F("body").css("cursor","wait");vBulletin.AJAX({call:"/ajax/api/node/requestChannel",data:{channelid:S,recipientname:U,requestType:"sg_moderator_to"},success:function(){location.reload()},complete:function(){F("body").css("cursor","default")},title_phrase:"add_moderator_gforumdisplay",error_phrase:"error_adding_moderator",})}function C(V){V.stopPropagation();var T=F(this).closest("form"),U=T.find(':input[name="nodeid"]').val(),S=F(this).attr("userid");F("body").css("cursor","wait");vBulletin.AJAX({call:"/ajax/api/blog/removeChannelModerator",data:{userId:S,channelId:U},success:function(W){location.reload()},complete:function(){F("body").css("cursor","default")},title_phrase:"delete_moderator",})}function G(W){W.stopPropagation();var V=F(this),T=V.closest("form"),U=T.find(':input[name="nodeid"]').val(),S=V.attr("userid");F("body").css("cursor","wait");vBulletin.AJAX({call:"/ajax/api/blog/cancelChannelTransfer",error_phrase:"error_transfer_ownership",data:{userId:S,channelId:U},success:function(){location.reload()},complete:function(){F("body").css("cursor","default")}})}function R(V){var S=F(this).closest("form"),T=S.find(':input[name="nodeid"]').val();var U=openConfirmDialog({title:vBulletin.phrase.get("transfer_group_ownership"),message:vBulletin.phrase.get("loading_ellipsis"),width:500,dialogClass:"transfer-ownership-dialog loading",buttonLabel:{yesLabel:vBulletin.phrase.get("send_request"),noLabel:vBulletin.phrase.get("cancel")},onClickYes:function(){var X="",W=0;if(F(".transfer-ownership-dialog .transfer_owner_select:visible").length>0){W=F(".transfer-ownership-dialog .transfer_owner_select").val()}else{X=F('.transfer-ownership-dialog :input[name="transfer_owner_autocomplete"]').val()}if(X.length==0&&(W.length==0||W==0)){return false}vBulletin.AJAX({call:"/ajax/api/node/requestChannel",data:{channelid:T,recipient:W,recipientname:X,requestType:"owner_to"},success:function(){location.reload()},complete:function(){F("body").css("cursor","default")},title_phrase:"transfer_group_ownership",error_phrase:"error_transfer_ownership",})}});vBulletin.AJAX({call:"/ajax/render/sgadmin_transferownership",data:({nodeid:T}),success:function(W){F(".transfer-ownership-dialog").removeClass("loading");F(".dialog-content .message",U).html(W);U.dialog("option","position",{of:window});transferOwnerAutocomplete=new vBulletin_Autocomplete(F(".transfer_owner_autocomplete"),{apiClass:"user",maxItems:1});F(".transfer_ownership_tabs").tabs()},after_error:function(){U.dialog("close")},})}function B(){var S=F(this).closest("form");var T=S.find(':input[name="nodeid"]').val();openConfirmDialog({title:vBulletin.phrase.get("delete_a_group_channel"),message:vBulletin.phrase.get("confirm_delete_group_channel"),iconType:"warning",onClickYes:function(){vBulletin.AJAX({call:"/ajax/api/content_channel/delete",data:{nodeid:T},success:function(){window.location.href=pageData.baseurl+"/social-groups";return false},complete:function(){F("body").css("cursor","default")},title_phrase:"delete_group",error_phrase:"error_deleting_group",});return false},onClickNo:function(){}});return false}function H(U){var T=F(".sgIconUploader");if(T.data("dialog-initialized")!="1"){T.dialog({width:600,autoOpen:false,modal:true,title:vBulletin.phrase.get("edit_group_icon"),dialogClass:"dialog-container",showCloseButton:false,}).data("dialog-initialized","1")}var S=!!F(U.target).closest(".sg-icon-wrapper").find(".groupIconImg").data("filedataid");F(".js-sgicon-remove",T).toggleClass("h-hide-imp",!S);F("input",T).first().click();T.dialog("open");return false}function N(U){var V=F(U.target).parent(".sgIconUrlInput").find("#imgUrl").val(),S=F(".sgIconUploader .js-upload-progress"),T=F(".js-sgicon-upload-form").data("update-channel");S.removeClass("h-hide-imp");vBulletin.AJAX({call:"/uploader/uploadSGIcon",error_phrase:"upload_errors",data:{nodeid:F(U.target).closest(".sgicon-upload-form").data("nodeid"),url:V,urlupload:V,updatechannel:T,},success:function(W){D(W.mediumUrl,W.filedataid)},complete:function(){S.addClass("h-hide-imp")}})}function P(U){var T=F(".js-sgicon-upload-form").data("update-channel");if(T){var S=F(".sgIconUploader .js-upload-progress").removeClass("h-hide-imp");vBulletin.AJAX({call:"/ajax/api/content_channel/update",error_phrase:"upload_errors",data:{nodeid:F(U.target).closest(".sgicon-upload-form").data("nodeid"),data:{filedataid:0,},},success:function(V){D("",0)},complete:function(){S.addClass("h-hide-imp")}})}else{D("",0)}}function D(V,T){var U=F(".groupIconImg"),S=!V;if(S){V=U.data("defaultimgurl");T=0}U.toggleClass("js-frame-image",!S).toggleClass("noGroupIcon",S).data("filedataid",T).attr("src",V);F(".sgIconUploader").dialog("close");F(".sGIconfiledataid").val(T);vBulletin.initFrameImagesWithColor()}function A(S){F(S.target).closest(".sgIconUploader").dialog("close")}function Q(X){var S=F(X.target),W=S.closest(".manage_moderators_row"),U=S.attr("data-userid"),T=S.attr("data-groupid"),V=S.attr("data-nodeid");if(U&&(U>0)&&T&&(T>0)&&V&&(V>0)){vBulletin.AJAX({call:"/ajax/api/blog/removeChannelMember",data:{userId:U,channelId:V},success:function(Y){W.remove()},complete:function(){F("body").css("cursor","default")},title_phrase:"manage_subscribers",})}}function I(W){var S=F(W.target),V=S.closest(".manage_moderators_row"),T=S.attr("data-userid"),U=S.attr("data-nodeid");if(T&&(T>0)&&U&&(U>0)){vBulletin.AJAX({call:"/ajax/api/follow/delete",data:{follow_item:U,type:"follow_channel",userid:T},success:function(X){V.remove()},complete:function(){F("body").css("cursor","default")},title_phrase:"manage_subscribers",})}}var O=1;function E(V){var S=F(V.target),U;pageCount=parseInt(S.closest(".groupAdminSubscriberPaging").attr("data-pagecount"));if(S.hasClass("left-arrow")||S.parent().hasClass("left-arrow")){U=O-1;if(U<1){S.addClass("h-disabled");return }}else{if(S.hasClass("right-arrow")||S.parent().hasClass("right-arrow")){U=O+1;if(U>pageCount){S.addClass("h-disabled");return }}else{if(S.hasClass("textbox")){U=parseInt(S.val());if(isNaN(U)||(U>pageCount)||(U<1)){S.val(this.pageno);return }}else{return }}}var T=S.closest(".groupAdminEditPage");vBulletin.AJAX({call:"/ajax/render/sgadmin_subscriberlist",data:{pageno:U,nodeid:F(V.target).closest(".groupAdminEditPage").attr("data-nodeid")},success:function(W){T.find(".subscriberList").html(W);T.find(".right-arrow").toggleClass("h-disabled",(U>=pageCount));T.find(".left-arrow").toggleClass("h-disabled",(U<=1));T.find(".pagenav .textbox").val(U);O=U;F(".groupRemoveSubscriber").off("click").on("click",I)},})}function J(U){category=F(U.target).find(".sgCategory");if(parseInt(category.val())<=0){vBulletin.error("groups","please_select_category");return false}title=F(U.target).find(".sGtitle");if(title.length&&title.val().trim().length<=0){vBulletin.error("groups","please_enter_title");return false}var T=F(U.target).find(".blogAdminNodeId").val();if(T>0){F.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/user/hasPermissions",data:{nodeid:T,group:"forumpermissions2",permission:"canconfigchannel",},type:"POST",dataType:"json",async:false,success:function(V){if(!V.errors){if(V===false){U.preventDefault();vBulletin.warning("social_groups","cannot_edit_group_info");return false}}else{vBulletin.warning("social_groups",V.errors[0][0]);return false}}})}var S=F(U.target);if(S.find('input[name="securitytoken"]').length){S.find('input[name="securitytoken"]').val(pageData.securitytoken)}else{S.append('<input type="hidden" name="securitytoken" value="'+pageData.securitytoken+'" />')}}F(document).ready(function(){var U=new vBulletin_Autocomplete(F(".moderator_input"),{apiClass:"user",maxItems:1,containerClass:"group-moderator-autocomplete",});F(".moderator_input").data("vbulletin-autocomplete",U);var W=new vBulletin_Autocomplete(F(".moderator_members_input"),{apiClass:"user",containerClass:"group-moderator-autocomplete"});F(".btnGroupReset").off("click").on("click",M);F(document).off("click",".add_moderator").on("click",".add_moderator",function(X){return K.call(this,X,U)});F(document).off("click",".btnRemoveContributor").on("click",".btnRemoveContributor",C);F(document).off("click",".btnCancelTransfer").on("click",".btnCancelTransfer",G);F(document).off("click",".btnTransferOwnership").on("click",".btnTransferOwnership",R);F(".groupRemoveSubscriber").off("click").on("click",I);F(".groupRemoveMember").off("click").on("click",Q);F(".groupAdminSubscriberPaging .right-arrow, .groupAdminSubscriberPaging .left-arrow").off("click").on("click",E);F(".groupAdminSubscriberPaging .pagenav .textbox").off("change").on("change",E);F("#btnGroupDelete").off("click").on("click",B);F(".editGroupIcon").off("click").on("click",H);F(".btnSGIconCancel").off("click").on("click",A);F(".btnSGIconUrlSubmit").off("click").on("click",N);F(".btnSGIconRemoveSubmit").off("click").on("click",P);F(".groupAdminSubscriberPaging .right-arrow ").removeClass("h-disabled");var S=F.cookie(pageData.cookie_prefix+"group_title");if(S!=null){F('.groupAdminForm :input[name="title"]').val(S.replace(/\+/g," "));F.cookie(pageData.cookie_prefix+"group_title",null,{path:pageData.cookie_path,domain:pageData.cookie_domain})}var V=F.cookie(pageData.cookie_prefix+"group_description");if(V!=null){F('.groupAdminForm :input[name="description"]').val(V.replace(/\+/g," "));F.cookie(pageData.cookie_prefix+"group_description",null,{path:pageData.cookie_path,domain:pageData.cookie_domain})}var T=F.cookie(pageData.cookie_prefix+"groupadmin_error");if(T!=null){vBulletin.error("groups",T);F.cookie(pageData.cookie_prefix+"groupadmin_error",null,{path:pageData.cookie_path,domain:pageData.cookie_domain})}F(".js-sg-admin__upload-icon").fileupload({dropZone:F(".js-sg-admin__upload-icon").closest(".js-file-chooser"),formData:function(X){return[{name:"nodeid",value:X.data("nodeid")},{name:"uploadFrom",value:X.find("input[name=uploadFrom]").val()},{name:"securitytoken",value:pageData.securitytoken},{name:"updatechannel",value:X.data("update-channel")},]},dataType:"json",url:vBulletin.getAjaxBaseurl()+"/uploader/uploadSGIcon",add:function(Z,Y){var X=/(gif|jpg|jpeg|jpe|png)$/i;if(X.test(Y.files[0].type)){F(".sgIconUploader .js-upload-progress").removeClass("h-hide-imp");Y.submit()}else{vBulletin.error("upload","invalid_image_allowed_filetypes_are")}},done:function(Z,Y){if(Y){var X=Y.result.errors;if(typeof (X)!="undefined"){if(typeof (X[0])!="undefined"){X=X[0]}vBulletin.error("group_icon",X)}else{if(Y.result.mediumUrl){D(Y.result.mediumUrl,Y.result.filedataid)}else{vBulletin.error("group_icon","unable_to_upload_file")}}}else{vBulletin.error("group_icon","invalid_server_response_please_try_again")}},fail:function(a,Y){var Z="error_uploading_image",X="error";if(Y&&Y.files.length>0){if(Y.files[0].error=="acceptFileTypes"){Z="invalid_image_allowed_filetypes_are";X="warning"}}vBulletin.alert("upload",Z,X,function(){$editProfilePhotoDlg.find(".fileText").val("");$editProfilePhotoDlg.find(".browse-option").focus()})},always:function(){F(".sgIconUploader .js-upload-progress").addClass("h-hide-imp")}});F(".sgAdminForm").submit(J)})})(jQuery);